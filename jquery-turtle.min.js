(function(a){function b(b,c){if(Ee>5)Fe.push({elem:b,qname:c});else{for(Ee+=1,a.dequeue(b,c);Fe.length>0;){var d=Fe.shift();a.dequeue(d.elem,d.qname),Mc()}Ee-=1}}function c(a,b){function c(){this.constructor=a}for(var d in b)Ae.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a}function d(b){var c,d,e=b.charAt(0).toUpperCase()+b.slice(1),f=["Moz","Webkit","O","ms"],g=document.createElement("div");if(b in g.style)d=b;else for(var h=0;h<f.length;h++)if(c=f[h]+e,c in g.style){d=c;break}return g=null,a.support[b]=d,d}function e(){var a=document.createElement("div"),b="getBoundingClientRect"in a;return a=null,b}function f(b,c){function d(){for(;m.length&&/^\s/.test(m[m.length-1]);)m.pop();for(;m.length&&/^\s/.test(m[0]);)m.shift();1==m.length&&(/^".*"$/.test(m[0])||/^'.*'$/.test(m[0]))?g=m[0].substr(1,m[0].length-2):2==m.length&&"url"==m[0]&&/^(.*)$/.test(m[1])?g=m[1].substr(1,m[1].length-2):(h=m.join(""),g=""==h?h:isNaN(h)?h:Number(h)),!l&&n&&c&&m.length&&(k=c),k&&(j[k]=g)}if("string"!=typeof b){if(null==b)return{};if(a.isPlainObject(b))return b;b=""+b}var e,f,g,h,i=b.match(/[-a-zA-Z_][-\w]*|"[^"]*"|'[^']'|\([^()]*\)|\s+|./g),j={},k=null,l=!1,m=[],n=!0;for(e=0;e<i.length;++e)f=i[e],l||(!k&&/^[a-zA-Z_-]/.test(f)&&(k=f),":"!=f)?";"!=f?m.push(f):(d(),k=null,m.length=0,l=!1,n=!1):(l=!0,m.length=0);return d(),j}function g(a){function b(a){return/[\s;]/.test(a)?a.indexOf('"')<0?'"'+a+'"':"'"+a+"'":a}var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push(d+":"+b(a[d])+";");return c.join(" ")}function h(a){return a}function i(a,b){var c=[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1]];return 6==a.length&&(c[0]+=a[4],c[1]+=a[5]),c}function j(a,b){var c=[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3]],d=6==a.length;return 6==b.length?(c.push(a[0]*b[4]+a[2]*b[5]+(d?a[4]:0)),c.push(a[1]*b[4]+a[3]*b[5]+(d?a[5]:0))):d&&(c.push(a[4]),c.push(a[5])),c}function k(a){return Math.abs(a)>1e-12}function l(a){return!(k(a[1])||k(a[2])||k(1-a[0])||k(1-a[3]))}function m(a){if(l(a))return[1,0,0,1];var b=u(a);return k(b[2])?j(o(-b[3]),j(p(1/b[1],1/b[2]),o(-b[0]))):null}function n(a){var b=m(a);if(4==a.length)return b;var c=i(b,[-a[4],-a[5]]);return b.push(c[0]),b.push(c[1]),b}function o(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,-c,b]}function p(a,b){return 1==arguments.length&&(a=b),[a,0,0,b]}function q(a,b){return[a[0]+b[0],a[1]+b[1]]}function r(a,b){return[a[0]-b[0],a[1]-b[1]]}function s(a,b){return[a[0]*b,a[1]*b]}function t(a,b,c){return q(i(a,r(b,c)),c)}function u(a){var b,c,d=a[0]*a[0]+a[1]*a[1],e=a[0]*a[2]+a[1]*a[3],f=a[2]*a[2]+a[3]*a[3],g=-.5*Math.atan2(2*e,d-f),h=Math.cos(g),i=Math.sin(g),j=a[0]*h-a[2]*i,k=a[1]*h-a[3]*i,l=Math.atan2(k,j),m=Math.cos(l),n=Math.sin(l),o=(a[1]*i+a[3]*h)*m-(a[0]*i+a[2]*h)*n,p=(a[0]*h-a[2]*i)*m+(a[1]*h-a[3]*i)*n;return g<-Math.PI/4?(g+=Math.PI/2,c=p,b=o,l-=Math.PI/2):(b=p,c=o),l>Math.PI&&(l-=2*Math.PI),[l,b,c,g]}function v(a,b){var c=(b-a)/2,d=Math.cos(c),e=Math.sin(c),f=d,g=-e,h=1+f*d+g*e,i=f*e-g*d,j=i&&4/3*(Math.sqrt(2*h)-h)/i,k=f-j*g,l=g+j*f,m=k,n=-l,o=c+a,p=Math.cos(o),q=Math.sin(o);return[[k*p-l*q,k*q+l*p],[m*p-n*q,m*q+n*p],[Math.cos(b),Math.sin(b)]]}function w(a){var b=qa(a,!1);if(b)return[b.tx,b.ty];var c=x(a);return c?[c[4],c[5]]:[0,0]}function x(b){var c=ze.getComputedStyle?ze.getComputedStyle(b)[Ge]:a.css(b,"transform");if(!c||"none"===c)return null;var d=/^matrix\(([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+),\s*([\-+.\de]+)(?:px)?,\s*([\-+.\de]+)(?:px)?\)$/.exec(c);return d?[parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]),parseFloat(d[4]),parseFloat(d[5]),parseFloat(d[6])]:A(c)}function y(b,c){var d,e,f,g,h,i="none"===a.css(b,"display");if(i){d={position:"absolute",visibility:"hidden",display:"block"},e={};for(f in d)e[f]=b.style[f],b.style[f]=d[f]}var g=ze.getComputedStyle?ze.getComputedStyle(b):null,h=g&&g[He]||a.css(b,"transformOrigin");if(i)for(f in d)b.style[f]=e[f];if(h&&h.indexOf("%")<0)return a.map(h.split(" "),parseFloat);if(c)return[c[0]/2,c[1]/2];var j=a(b);return[j.width()/2,j.height()/2]}function z(a){for(var b,c=[1,0,0,1];null!==a;)b=x(a),b&&!l(b)&&(c=j(b,c)),a=a.parentElement;return c.slice(0,4)}function A(b){var c=[1,0,0,1],d=[],e=[],f=/(?:^\s*|)(\w*)\s*\(([^)]*)\)\s*/g,g=b.replace(f,function(b){return d.push(b[1].toLowerCase()),e.push(a.map(b[2].split(","),function(a){var b=a.trim().toLowerCase();return{num:parseFloat(b),unit:b.replace(/^[+-.\de]*/,"")}})),""});if(g)return null;for(var h=d.length-1;h>=0;--h){var i,k,l,m=null,n=d[h],o=e[h];if("matrix"==n)o.length>=6&&(m=[o[0].num,o[1].num,o[2].num,o[3].num,o[4].num,o[5].num]);else if("rotate"==n)1==o.length&&(i=ua(o[0]),k=Math.cos(i),l=Math.sin(i),m=[k,-l,k,l]);else if("translate"==n||"translatex"==n||"translatey"==n){var p=0,q=0;if(o.length>=1){if(o[0].unit&&"px"!=o[0].unit)return null;if("translate"==n||"translatex"==n?p=o[0].num:"translatey"==n&&(q=o[0].num),"translate"==n&&o.length>=2){if(o[1].unit&&"px"!=o[1].unit)return null;q=o[1].num}m=[0,0,0,0,p,q]}}else if("scale"==n||"scalex"==n||"scaley"==n){var r=1,s=1;o.length>=1&&("scale"==n||"scalex"==n?r=o[0].num:"scaley"==n&&(s=o[0].num),"scale"==n&&o.length>=2&&(s=o[1].num),m=[r,0,0,s,0,0])}else{if("skew"!=n&&"skewx"!=n&&"skewy"!=n)return null;var t=0,u=0;o.length>=1&&("skew"==n||"skewx"==n?t=Math.tan(ua(o[0])):"skewy"==n&&(u=Math.tan(ua(o[0]))),"skew"==n&&o.length>=2&&(u=Math.tan(ua(o[0]))),m=[1,u,t,1,0,0])}c=j(c,m)}return c}function B(a,b,c){if(0>=c)return a;var d=b.pageX-a.pageX,e=b.pageY-a.pageY,f=d*d+e*e;if(c*c>=f)return b;var g=c/Math.sqrt(f);return{pageX:a.pageX+g*d,pageY:a.pageY+g*e}}function C(a,b,c){if(0>=c)b=a;else if(180>c){var d=va(b-a);d>c?b=a+c:-c>d&&(b=a-c)}return va(b)}function D(a,b,c,d){return{pageX:Math.floor(a+c/2),pageY:Math.floor(b+d/2)}}function E(a,b,c,d){var e=a+c,f=b+d;return[{pageX:a,pageY:b},{pageX:a,pageY:f},{pageX:e,pageY:f},{pageX:e,pageY:b}]}function F(a){if(!/e[\-+]/.exec(a))return a;var b=a.replace(/(?:\d+(?:\.\d*)?|\.\d+)e[\-+]\d+/g,function(a){return ra(parseFloat(a))});return b}function G(b,c,d){var e=a.data(b,"turtleData");if(e&&e.quickhomeorigin&&e.down&&e.style&&!d)return e.quickhomeorigin;var f,g,h,i,j="none"===a.css(b,"display"),k=j?{position:"absolute",visibility:"hidden",display:"block"}:{},l=(k[Ge]=c?"matrix("+a.map(c,ra).join(", ")+", 0, 0)":"none",{});for(f in k)l[f]=b.style[f],b.style[f]=k[f];g=N(b),h=y(b,[g.width,g.height]);for(f in k)b.style[f]=F(l[f]);d&&(d.gbcr=g,d.localorigin=h);var i=q([g.left,g.top],h);return e&&e.down&&e.style&&(e.quickhomeorigin=i),i}function H(){return ze.innerHeight||a(ze).height()}function I(){return ze.innerWidth||a(ze).width()}function J(){return document.body?a(document).height():document.height}function K(){return document.body?a(document).width():document.width}function L(a){return a.offsetHeight<=0&&a.offsetWidth<=0}function M(a,b,c,d){return{left:a,top:b,right:a+c,bottom:b+d,width:c,height:d}}function N(b){return kb(b)?M(b.pageX,b.pageY,0,0):a.isWindow(b)?M(a(ze).scrollLeft(),a(ze).scrollTop(),I(),H()):9===b.nodeType?M(0,0,K(),J()):"getBoundingClientRect"in b?T.apply(b):M(0,0,0,0)}function O(a,b,c){var d=Math.max(0,Math.max(c.top-a.pageY,a.pageY-c.bottom)),e=Math.max(0,Math.max(c.left-a.pageX,a.pageX-c.right));return e*e+d*d>b}function P(a,b,c){var d=Math.max(c.bottom-a.pageY,a.pageY-c.top),e=Math.max(c.right-a.pageX,a.pageX-c.left);return b>e*e+d*d}function Q(a,b){return b.right<a.left||a.right<b.left||b.bottom<a.top||a.bottom<b.top}function R(a,b){return b.top>=a.top&&b.bottom<=a.bottom&&b.left>=a.left&&b.right<=a.right}function S(a,b){return 4===a.length&&a[0].pageX===b.left&&a[0].pageY===b.top&&a[1].pageX===b.left&&a[1].pageY===b.bottom&&a[2].pageX===b.right&&a[2].pageY===b.bottom&&a[3].pageX===b.right&&a[3].pageY===b.top}function T(){var a=this.getBoundingClientRect();return{top:a.top+ze.pageYOffset,bottom:a.bottom+ze.pageYOffset,left:a.left+ze.pageXOffset,right:a.right+ze.pageXOffset,width:a.width,height:a.height}}function U(b,c,d,e,f){var g,h,j,k,l=z(b.parentElement),n=m(l),o=G(b,n);if(n){if(a.isNumeric(d)&&(j=w(b),g=q(i(l,j),o),h={pageX:g[0],pageY:g[1]},c=B(h,c,d)),k=i(n,r([c.pageX,c.pageY],o)),e||f){var p=qa(b,!0),s=p?p.sy:1;k[0]+=e*s,k[1]-=f*s}return ra(k[0])+" "+ra(k[1])}}function V(a){var b=a.offsetParent;return b?b:document}function W(b,c){c||(c=a(V(b)).pagexy());var d=z(b.parentElement),e=m(d),f=G(b,e),g=qa(b,!0),h=e&&i(e,r([c.pageX,c.pageY],f)),j=g&&1/g.sy;if(e)return[(g.tx-h[0])*j,(h[1]-g.ty)*j]}function X(b,c){var d,e,f=z(b.parentElement),g=qa(b,!0),h=a(V(b)).pagexy(),j=[];for(e=0;e<c.length;e++)d=i(f,[c[e][0]*g.sy,-c[e][1]*g.sy]),j.push({pageX:h.pageX+d[0],pageY:h.pageY+d[1]});return j}function Y(b){if(a.isWindow(b))return D(a(ze).scrollLeft(),a(ze).scrollTop(),I(),H());if(9===b.nodeType||b==document.body)return D(0,0,K(),J());var c=Ma(b);if(c&&c.quickpagexy&&c.down&&c.style)return c.quickpagexy;var d=w(b),e=z(b.parentElement),f=l(e),g=f?null:m(e),h=G(b,g),j=q(i(e,d),h),k={pageX:j[0],pageY:j[1]};return c&&f&&c.down&&c.style&&(c.quickpagexy=k),k}function Z(a,b){if(!a)return null;for(var c=[],d=0;d<a.length;++d)c.push([a[d].pageX+b[0],a[d].pageY+b[1]]);return c}function $(b,c){if(a.isWindow(b))return E(a(ze).scrollLeft(),a(ze).scrollTop(),I(),H());if(9===b.nodeType)return E(0,0,K(),J());var d=x(b)||[1,0,0,1],e=z(b.parentElement),f=j(e,d),g=m(e),h={},i=G(b,g,h),k=h.gbcr,l=Z(Ma(b).hull,i)||[[k.left,k.top],[k.left,k.bottom],[k.right,k.bottom],[k.right,k.top]];return c?a.map(l,function(a){return{pageX:a[0]-i[0],pageY:a[1]-i[1]}}):a.map(l,function(a){var b=t(f,a,i);return{pageX:b[0],pageY:b[1]}})}function _(a){var b=qa(a,!0),c=ua(va(b.rot)),d=Math.sin(c),e=Math.cos(c),f=z(a.parentElement),g=i(f,[d,e]),h=Math.atan2(g[0],g[1]);return ta(h)}function aa(b,c){var d=b.pageX,e=b.pageY,f=I()/2,g=H()/2,h=a("body"),i=h.width(),j=h.height(),k=a(ze);d>i-f&&(d=i-f),f>d&&(d=f),e>j-g&&(e=j-g),g>e&&(e=g),targ={pageX:d,pageY:e},a.isNumeric(c)&&(targ=B(k.origin(),targ,c)),k.scrollLeft(targ.pageX-f),k.scrollTop(targ.pageY-g)}function ba(a,b,c){var d=b.pageX-a.pageX,e=b.pageY-a.pageY,f=c.pageX-a.pageX,g=c.pageY-a.pageY;return f*e-d*g}function ca(a,b,c){var d=c.pageX-a.pageX,e=c.pageY-a.pageY;return d*b.pageY-b.pageX*e}function da(a,b){if(b.length<=0)return!1;if(1==b.length)return b[0].pageX==a.pageX&&b[0].pageY==a.pageY;var c=ba(a,b[b.length-1],b[0]);if(0===c)return!0;var d=c>0;if(2==b.length)return!1;for(var e=1;e<b.length;++e){var f=ba(a,b[e-1],b[e]);if(0===f)return!0;if(f>0!=d)return!1}return!0}function ea(a,b){return{pageX:a.pageX-b.pageX,pageY:a.pageY-b.pageY}}function fa(a,b,c,d){var e,f,g=ea(c,b);for(e=0;e<d.length;++e)if(f=ga(ca(b,g,d[e])),!f||f===a)return!1;return!0}function ga(a){return a>0?1:0>a?-1:0}function ha(a){if(a.length<=2)return 0;var b=ba(a[a.length-1],a[0],a[1]);if(0!==b)return ga(b);for(var c=1;c<a.length;++c)if(b=ba(a[c-1],a[c],a[(c+1)%a.length]),0!==b)return ga(b);return 0}function ia(a,b){var c,d=ha(a);for(c=0;c<a.length;++c)if(fa(d,a[c],a[(c+1)%a.length],b))return!1;for(d=ha(b),c=0;c<b.length;++c)if(fa(d,b[c],b[(c+1)%b.length],a))return!1;return!0}function ja(a,b){for(var c=0;c<b.length;++c)if(!da(b[c],a))return!1;return!0}function ka(a){function b(a,b){if(!b||!kb(b))return a;for(;a.length>1&&1!=ga(ba(a[a.length-2],a[a.length-1],b));)a.pop();return a.length&&d(a[a.length-1],b)||a.push(b),a}function c(a,b,c){for(var d=0;d<a.length;++d)b=c(b,a[d]);return b}function d(a,b){return a.pageX===b.pageX&&a.pageY===b.pageY}function e(a,b){return a.pageX<b.pageX?-1:a.pageX>b.pageX?1:a.pageY<b.pageY?-1:a.pageY>b.pageY?1:0}a.sort(e);var f=c(a,[],b),g=c(a.reverse(),[],b);return f.concat(g.slice(1,-1))}function la(b){if(!b)return null;if(a.isArray(b))return b;for(var c=a.map(b.trim().split(/\s+/),parseFloat),d=[],e=0;e+1<c.length;)d.push({pageX:c[e],pageY:c[e+1]}),e+=2;return d}function ma(b){for(var c=0,d=[];c<b.length;++c)d.push(b[c].pageX,b[c].pageY);return d.length?a.map(d,ra).join(" "):"none"}function na(){return{get:function(a,b,c){var d=Ma(a).hull;return ma(d||$(a,!0))},set:function(a,b){var c=b&&"auto"!=b?"none"==b?[]:ka(la(b)):null;Ma(a).hull=c}}}function oa(a){if("none"===a)return{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0};var b=/^(?:translate\(([\-+.\de]+)(?:px)?,\s*([\-+.\de]+)(?:px)?\)\s*)?(?:rotate\(([\-+.\de]+)(?:deg)?\)\s*)?(?:scale\(([\-+.\de]+)(?:,\s*([\-+.\de]+))?\)\s*)?(?:rotate\(([\-+.\de]+)(?:deg)?\)\s*)?$/.exec(a);if(!b)return null;var c=b[1]?parseFloat(b[1]):0,d=b[2]?parseFloat(b[2]):0,e=b[3]?parseFloat(b[3]):0,f=b[4]?parseFloat(b[4]):1,g=b[5]?parseFloat(b[5]):f,h=b[6]?parseFloat(b[6]):0;return{tx:c,ty:d,rot:e,sx:f,sy:g,twi:h}}function pa(a){var b,c=x(a);return c?(b=u(c),{tx:c[4],ty:c[5],rot:ta(b[0]),sx:b[1],sy:b[2],twi:ta(b[3])}):{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0}}function qa(a,b){return oa(a.style[Ge])||b&&pa(a)}function ra(a){var b=a.toString();return~b.indexOf("e")&&(b=Number(a).toFixed(17)),b}function sa(a){var b=[];return(k(a.tx)||k(a.ty))&&b.push("translate("+ra(a.tx)+"px, "+ra(a.ty)+"px)"),(k(a.rot)||k(a.twi))&&b.push("rotate("+ra(a.rot)+"deg)"),(k(1-a.sx)||k(1-a.sy))&&(k(a.sx-a.sy)?b.push("scale("+ra(a.sx)+", "+ra(a.sy)+")"):b.push("scale("+ra(a.sx)+")")),k(a.twi)&&b.push("rotate("+ra(a.twi)+"deg)"),b.length?b.join(" "):"none"}function ta(a){var b=180*a/Math.PI;return b>180&&(b-=360),b}function ua(a){return a*Math.PI/180}function va(a){return Math.abs(a)>180&&(a%=360,a>180?a-=360:-180>=a&&(a+=360)),a}function wa(a){return Math.abs(a)>=720&&(a=a%360+(a>0?360:-360)),a}function xa(){return Ie.field||za(),Ie.field}function ya(){return Ie.surface||za(),Ie.surface}function za(){var b=document.createElement("samp"),c=document.createElement("samp"),d=Math.floor(I()/2),e=Math.floor(H()/2);a(b).css({position:"absolute",display:"inline-block",top:0,left:0,width:"100%",height:"100%",font:"inherit",zIndex:-1,transformOrigin:d+"px "+e+"px",pointerEvents:"none",overflow:"hidden"}).addClass("turtlefield"),a(c).attr("id","field").css({position:"absolute",display:"inline-block",top:e,left:d,width:"100%",height:"0",font:"inherit",transformOrigin:"0px 0px",pointerEvents:"all"}).appendTo(b),Ie.surface=b,Ie.field=c,Aa(),Qb()}function Aa(){document.body?(null==a("html").attr("style")&&a("html").css("min-height","100%"),a(Ie.surface).prependTo("body"),Pb()):a(document).ready(Aa)}function Ba(a){return a.drawOnCanvas||(a.drawOnCanvas=Da()),a.drawOnCanvas}function Ca(b){var c=a.data(b,"turtleData");return c?c.drawOnCanvas?c.drawOnCanvas:Ie.canvas:null}function Da(){if(Ie.canvas)return Ie.canvas;var b=ya();return Ie.canvas=document.createElement("canvas"),a(Ie.canvas).css({"z-index":-1}),b.insertBefore(Ie.canvas,b.firstChild),Ha(),Fa(Ha),a(ze).resize(Ha),Ie.canvas}function Ea(a,b){return Ie.offscreen&&Ie.offscreen.width===a&&Ie.offscreen.height===b?(Ie.offscreen.getContext("2d").clearRect(0,0,a,b),Ie.offscreen):(Ie.offscreen||(Ie.offscreen=document.createElement("canvas")),Ie.offscreen.width=a,Ie.offscreen.height=b,Ie.offscreen)}function Fa(b){var c=a("body"),d=c.width(),e=c.height(),f=function(){(c.width()!=d||c.height()!=e)&&(b(),d=c.width(),e=c.height())};Ie.timer&&clearInterval(Ie.timer),Ie.timer=setInterval(f,250)}function Ga(){var b=a("body");return[Math.max(b.outerWidth(!0),ze.innerWidth||a(ze).width()),Math.max(b.outerHeight(!0),ze.innerHeight||a(ze).height())]}function Ha(){if(Ie.canvas){var b,c=Ga(),d=c[0],e=c[1],f=Ie.canvas.width,g=Ie.canvas.height,h=Math.max(Math.min(2e3,Math.max(200,f)),100*Math.ceil(d/100))*Ie.subpixel,i=Math.max(Math.min(2e3,Math.max(200,f)),100*Math.ceil(e/100))*Ie.subpixel;a(Ie.surface).css({width:d+"px",height:e+"px"}),(f!=h||g!=i)&&(b=document.createElement("canvas"),b.width=Math.min(f,h),b.height=Math.min(g,i),b.getContext("2d").drawImage(Ie.canvas,0,0),Ie.canvas.width=h,Ie.canvas.height=i,Ie.canvas.getContext("2d").drawImage(b,0,0),a(Ie.canvas).css({width:h/Ie.subpixel,height:i/Ie.subpixel}))}}function Ia(a,b){if(!a)return null;if(a&&"function"==typeof a&&(a.helpname||a.name)&&(a=a.helpname||a.name),a=String(a),a.trim&&(a=a.trim()),!a||"none"===a)return null;if("path"===a||"fill"===a)return{savePath:!0};var c=!1;/^erase\b/.test(a)&&(a=a.replace(/^erase\b/,"white; globalCompositeOperation:destination-out"),c=!0);var d=f(a,b);return c&&(d.eraseMode=!0),d}function Ja(a){return a?g(a):"none"}function Ka(a){return"down"==a||a===!0?!0:"up"==a||a===!1?!1:ye}function La(a){return a?"down":"up"}function Ma(b){var c=a.data(b,"turtleData");return c||(c=a.data(b,"turtleData",{style:null,corners:[[]],path:[[]],down:!1,speed:"turtle",easing:"swing",turningRadius:0,drawOnCanvas:null,quickpagexy:null,quickhomeorigin:null,instrument:null,stream:null})),c}function Na(b){var c=a.data(b,"turtleData");return c?c.turningRadius:0}function Oa(){return{get:function(a,b,c){return ra(Na(a))+"px"},set:function(a,b){var c=parseFloat(b);if(!isNaN(c)&&(Ma(a).turningRadius=c,a.style.turtleTurningRadius=""+ra(c)+"px",0===c)){var d=qa(a,!1);d&&(d.rot>180||d.rot<=-180)&&(d.rot=va(d.rot),a.style[Ge]=sa(d))}}}}function Pa(){return{get:function(a,b,c){return Ja(Ma(a).style)},set:function(a,b){var c=Ia(b,"strokeStyle"),d=Ma(a);d.style&&(d.style=null,_a(a,d,!0)),d.style=c,a.style.turtlePenStyle=Ja(c),_a(a,d,!0)}}}function Qa(){return{get:function(a,b,c){return La(Ma(a).down)},set:function(a,b){var c=Ka(b);if(c!==ye){var d=Ma(a);c!=d.down&&(d.down=c,d.quickpagexy=null,d.quickhomeorigin=null,a.style.turtlePenDown=La(c),_a(a,d,!0))}}}}function Ra(a,b){return 0===Math.round(a.pageX-b.pageX)&&0===Math.round(a.pageY-b.pageY)}function Sa(a,b){return 0===Math.round(1e3*(a.pageX-b.pageX))&&0===Math.round(1e3*(a.pageY-b.pageY))}function Ta(a,b){return Ra(a,b)&&0===Math.round(a.pageX-b.pageX1)&&0===Math.round(a.pageY-b.pageY1)&&0===Math.round(b.pageX2-b.pageX)&&0===Math.round(b.pageY2-b.pageY)}function Ua(a){var b=1e3*a,c=Math.round(b);return Math.abs(c-b)<Math.abs(5e-15*b)?c/1e3:a}function Va(a,b,c){c=c||1;var d=b.eraseMode?1:0;if(b&&"strokeStyle"in b||(a.strokeStyle="black"),b&&"lineWidth"in b||(a.lineWidth=1.62*c+d),b&&"lineCap"in b||(a.lineCap="round"),b&&"lineJoin"in b||(a.lineJoin="round"),b)for(var e in b)"savePath"!==e&&"eraseMode"!==e&&(c&&"lineWidth"===e?a[e]=c*b[e]+d:"lineDash"===e?a.setLineDash((""+b[e]).split(/[,\s]/g)):a[e]=b[e])}function Wa(a){if(a){if(a===Ie.canvas)return[Ie.subpixel,0,0,Ie.subpixel];var b,c=z(a.parentElement),d=m(c),e={},f=G(a,d,e),g=e.gbcr,h=[1,0,0,1,-f[0],-f[1]],i=g.width&&g.height&&[a.width/g.width,0,0,a.height/g.height],k=x(a)||[1,0,0,1],l=n(k);if(d&&l&&i)return b=j(j(j(i,l),d),h),b[4]+=e.localorigin[0]*i[0],b[5]+=e.localorigin[1]*i[3],b}}function Xa(a,b){if(b===Ie.canvas)a.setTransform(Ie.subpixel,0,0,Ie.subpixel,0,0);else{var c=Wa(b);c&&a.setTransform.apply(a,c)}}function Ya(a,b,c,d,e){var f,g,h,i=a.getContext("2d"),j=b.length;for(i.save(),Xa(i,a),i.beginPath(),Va(i,c,d);j--;)if(b[j].length>1){h=b[j],f=h.length>2&&Ra(h[0],h[h.length-1])&&!Ra(h[0],h[Math.floor(h.length/2)]),g=f&&!("pageX2"in h[h.length-1]);var k=h[0].pageX,l=h[0].pageY;i.moveTo(k,l);for(var m=1;m<h.length-(g?1:0);++m)"pageX2"in h[m]&&!Ta(h[m-1],h[m])?i.bezierCurveTo(h[m].pageX1,h[m].pageY1,h[m].pageX2,h[m].pageY2,h[m].pageX,h[m].pageY):i.lineTo(h[m].pageX,h[m].pageY);f&&i.closePath()}"fillStyle"in c&&i.fill(),"strokeStyle"in c&&i.stroke(),i.restore(),b.length=1,b[0].splice(0,Math.max(0,b[0].length-e))}function Za(a,b,c){a.length&&Ra(b,a[a.length-1])||a.push(b);for(var d=0;d<c.length;++d)a.push({pageX1:c[d][0].pageX,pageY1:c[d][0].pageY,pageX2:c[d][1].pageX,pageY2:c[d][1].pageY,pageX:c[d][2].pageX,pageY:c[d][2].pageY})}function $a(a,b){a.length&&(b.corner?Sa(b,a[a.length-1]):Ra(b,a[a.length-1]))||a.push(b)}function _a(a,b,c){if(b){var d=b.path,e=b.style,f=b.corners;if(!e||!b.down)return d.length>1&&(d.length=1),d[0].length&&(d[0].length=0),void(c&&(e?f.length&&f[0].length&&(1==f[0].length?f[0].length=0:f.unshift([])):(f.length>1&&(f.length=1),f[0].length&&(f[0].length=0))));if(c||!e.savePath){var g=Y(a);if(c&&(g.corner=!0,$a(f[0],g)),!e.savePath){$a(d[0],g);var h=qa(a,!0);Ya(Ba(b),b.path,e,h.sx,2)}}}}function ab(b,c){var d=qa(b,!0),e=Ma(b);e.style&&(c=a.extend({},e.style,c)),Ya(Ba(e),e.corners,c,d.sx,1)}function bb(b){if((!b||/\bcanvas\b/.test(b))&&Ie.canvas){var c=Ie.canvas.getContext("2d");c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,Ie.canvas.width,Ie.canvas.height),c.restore()}if((!b||/\bturtles\b/.test(b))&&Ie.surface){var d=a(Ie.surface).find(".turtle").not(".turtlefield");ff&&(d=d.not(ff)),d.remove()}if((!b||/\blabels\b/.test(b))&&Ie.surface){var d=a(Ie.surface).find(".turtlelabel").not(".turtlefield");d.remove()}(!b||/\btext\b/.test(b))&&a("body").contents().not(".turtlefield").remove()}function cb(a,b){if(!a||a.length<1)return null;for(var c=1,d={left:Math.floor(a[0].pageX),top:Math.floor(a[0].pageY),right:Math.ceil(a[0].pageX),bottom:Math.ceil(a[0].pageY)};c<a.length;++c)d.left=Math.min(d.left,Math.floor(a[c].pageX)),d.top=Math.min(d.top,Math.floor(a[c].pageY)),d.right=Math.max(d.right,Math.ceil(a[c].pageX)),d.bottom=Math.max(d.bottom,Math.ceil(a[c].pageY));return b&&(d.left=Math.max(b.left,d.left),d.top=Math.max(b.top,d.top),d.right=Math.min(b.right,d.right),d.bottom=Math.min(b.bottom,d.bottom)),d}function db(a,b){if(!a||!b)return null;if(4==a.length&&l(a))return b;var c,d,e=[];for(c=0;c<b.length;++c)d=i(a,[b[c].pageX,b[c].pageY]),e.push({pageX:d[0],pageY:d[1]});return e}function eb(a,b){if(!a)return!1;var c=Xc(b),d=Ca(a);if(!d)return c&&0==c[3];var e,f=Wa(d),g=$(a),h=db(f,g),i=cb(h,{left:0,top:0,right:d.width,bottom:d.height}),j=i.right-i.left,k=i.bottom-i.top,l=Ea(j,k),m=l.getContext("2d"),c=Xc(b),n=1;if(!h||h.length<3||!j||!k)return!1;for(m.drawImage(d,i.left,i.top,j,k,0,0,j,k),m.save(),m.beginPath(),m.moveTo(0,0),m.lineTo(j,0),m.lineTo(j,k),m.lineTo(0,k),m.closePath(),m.moveTo(h[0].pageX-i.left,h[0].pageY-i.top);n<h.length;n+=1)m.lineTo(h[n].pageX-i.left,h[n].pageY-i.top);m.closePath(),m.clip(),c&&0==c[3]?m.fillRect(0,0,j,k):m.clearRect(0,0,j,k),m.restore();var e=m.getImageData(0,0,j,k).data;if(c&&0!=c[3]){for(n=0;n<e.length;n+=4)if(Math.abs(e[n+0]-c[0])<=3&&Math.abs(e[n+1]-c[1])<=3&&Math.abs(e[n+2]-c[2])<=3&&e[n+3]<=2*c[3]&&e[n+3]>=c[3]/2)return!0}else{var o=!c;for(n=0;n<e.length;n+=4)if(e[n+3]>0==o)return!0}return!1}function fb(a,b,c){if(b.img)("CANVAS"==a[0].tagName||a[0].tagName==b.img.tagName)&&Ib(b.img,a[0],b.css);else if("IMG"==a[0].tagName||"CANVAS"==a[0].tagName)Fb(a[0],b.url,b.css,c),c=null;else{var d={backgroundImage:"url("+b.url+")",backgroundRepeat:"no-repeat",backgroundPosition:"center"};b.css.width&&b.css.height&&(d.backgroundSize=b.css.width+"px "+b.css.height+"px"),a.css(d)}c&&c()}function gb(b,c,d){var e,f=qa(b,!0),g=f&&ua(f.rot),h=f&&c*f.sy,i=f&&(d||0)*f.sy,j=-Math.cos(g)*h,k=Math.sin(g)*h,l=a.data(b,"turtleData");f&&(d&&(j+=Math.sin(g)*i,k+=Math.cos(g)*i),l&&(e=l.quickpagexy)&&(l.quickpagexy={pageX:e.pageX+k,pageY:e.pageY+j}),f.tx+=k,f.ty+=j,b.style[Ge]=sa(f),_a(b,l,!0))}function hb(b,c,d){var e,f=qa(b,!0),g=a.data(b,"turtleData");f&&(g&&(e=g.quickpagexy)&&(g.quickpagexy={pageX:e.pageX+c,pageY:e.pageY-d}),f.tx+=c,f.ty-=d,b.style[Ge]=sa(f),_a(b,g,!0))}function ib(a,b){var c=qa(a,!0);c&&(c.rot+=b,a.style[Ge]=sa(c))}function jb(a,b,c){var d=qa(a,!0),e=d&&ua(d.rot),f=d&&b*d.sy,g=d&&(c||0)*d.sy,h=-Math.cos(e)*f,i=Math.sin(e)*f;if(d)return g&&(h+=Math.sin(e)*g,i+=Math.cos(e)*g),ra(d.tx+i)+" "+ra(d.ty+h)}function kb(b){return b&&a.isNumeric(b.pageX)&&a.isNumeric(b.pageY)}function lb(){return{get:function(a,b,c){return Ma(a).speed},set:function(b,c){(a.isNumeric(c)&&!(0>=c)||c in a.fx.speeds||""+c=="Infinity")&&(Ma(b).speed=""+c)}}}function mb(){return{get:function(a,b,c){return Ma(a).easing},set:function(b,c){c in a.easing&&(Ma(b).easing=c)}}}function nb(b,c){var d=a.data(b,"turtleData");return c=c||uf,d?a.isNumeric(d.speed)||"Infinity"==d.speed?1e3/d.speed:"turtle"==d.speed&&c?0:d.speed:c?0:"turtle"}function ob(b){var c=a.data(b,"turtleData");return c?c.easing:null}function pb(){return{get:function(a,b,c){var d=qa(a,b),e=y(a);if(d){var f=ua(d.rot),g=Math.cos(f),h=Math.sin(f);return ra(((d.tx+e[0])*h-(d.ty+e[1])*g)/d.sy)+"px"}},set:function(b,c){var d,e=qa(b,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},f=y(b),g=parseFloat(c)*e.sy,h=ua(e.rot),i=Math.cos(h),j=Math.sin(h),k=(e.tx+f[0])*i+(e.ty+f[1])*j,l=k*i+g*j-f[0],m=k*j-g*i-f[1],n=a.data(b,"turtleData");n&&(d=n.quickpagexy)&&(n.quickpagexy={pageX:d.pageX+(l-e.tx),pageY:d.pageY+(m-e.ty)}),e.tx=l,e.ty=m,b.style[Ge]=sa(e),_a(b,n)}}}function qb(b,c,d,e){return{get:function(a,c,e){var f=qa(a,c);return f?f[b]+d:void 0},set:function(d,f){var g,h=qa(d,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},i={displace:e},j=a.data(d,"turtleData"),k=h.tx,l=h.ty;h[b]=c(f,d,h,i),d.style[Ge]=sa(h),i.displace&&(j&&(g=j.quickpagexy)&&(j.quickpagexy={pageX:g.pageX+(h.tx-k),pageY:g.pageY+(h.ty-l)}),_a(d,j))}}}function rb(a,b,c){var d=wa(b-a),e=d>0?c:-c,f=ua(a),g=[Math.cos(f)*e,Math.sin(f)*e],h=ua(b);return{delta:d,sradius:e,dc:g,dx:g[0]-Math.cos(h)*e,dy:g[1]-Math.sin(h)*e}}function sb(a,b,c,d,e,f){var g,h,j,k,l,m,n,o,p,r,t,u=rb(c,d,e),w=u.sradius,x=u.dc;for(n=1,o=u.delta,p=Math.abs(u.delta),p>45&&(n=Math.ceil(p/45),o=u.delta/n),r=[];--n>=0;)g=0===n?d:c+o,h=ua(c+180),j=ua(g+180),r.push.apply(r,v(h,j)),c=g;for(t=[],k=0;k<r.length;k++)l=i(f,q(s(r[k],w),x)),t.push({pageX:l[0]+b.pageX,pageY:l[1]+b.pageY});for(m=[],k=0;k<t.length;k+=3)m.push(t.slice(k,k+3));return Za(a,b,m),u}function tb(b,c,d,e){b=parseFloat(b);var f=a.data(c,"turtleData"),g=f?f.turningRadius:0;if(0===g||d.rot==b)return e.displace=!1,0===g?va(b):b;var h,i=f&&f.style&&f.down,j=g*d.sy;return h=i?sb(f.path[0],Y(c),d.rot,b,j,z(c.parentElement)):rb(d.rot,b,j),d.tx+=h.dx,d.ty+=h.dy,e.displace=!0,b}function ub(b){return function(c){c.delta||(c.delta=wa(c.end-c.start),c.start=c.end-c.delta),a.cssHooks[b].set(c.elem,c.start+c.delta*c.pos)}}function vb(b,c){b.length&&"_"===b[0]&&(b=b.substring(1));for(var d=a.map((""+b).split(/\s+/),parseFloat);d.length<2;)d.push(c?d.length?d[d.length-1]:1:0);return d}function wb(b,c){return function(d){if(!d.delta){var e=vb(d.end,!c);d.start=vb(d.start,!c),d.delta=[e[0]-d.start[0],e[1]-d.start[1]]}a.cssHooks[b].set(d.elem,[d.start[0]+d.delta[0]*d.pos,d.start[1]+d.delta[1]*d.pos].join(" "))}}function xb(b,c,d,e){return{get:function(a,b,f){var g=qa(a,b);return g?e||g[c]!=g[d]?(""===f?"_":"")+g[c]+" "+g[d]:""+g[c]:void 0},set:function(b,f,g){var h,i=qa(b,!0)||{tx:0,ty:0,rot:0,sx:1,sy:1,twi:0},j="string"==typeof f?f.split(/\s+/):[f],k=a.data(b,"turtleData"),l=i.tx,m=i.ty;j.length<1||j.length>2||(j.length>=1&&(i[c]=parseFloat(j[0])),j.length>=2?i[d]=parseFloat(j[1]):e?i[d]=0:i[d]=i[c],b.style[Ge]=sa(i),e&&(k&&(h=k.quickpagexy)&&(k.quickpagexy={pageX:h.pageX+(i.tx-l),pageY:h.pageY+(i.ty-m)}),_a(b,k)))}}}function yb(a){return Je.href=a,Je}function zb(a){return yb(a).href}function Ab(a){return/(?:^|\.)pencil(?:code)?\./i.test(a)}function Bb(a){var b=yb(null==a?"":a).hostname,c=/^(\w+)\.pencil(?:code)?\./i.exec(b);return c?c[1]:null}function Cb(a,b){var c=yb(null==a?"":a),d=c.href;return Ab(c.hostname)?/^\/(?:edit|home|code|load|save)(?:\/|$)/.test(c.pathname)&&(d=c.protocol+"//"+c.host+"/"+b+"/"+c.pathname.replace(/\/[^\/]*(?:\/|$)/,"")+c.search+c.hash):Ab(ze.location.hostname)&&(d="/proxy/"+d),d}function Db(a){return/\//.test(a)?a:(a="/img/"+a,Ab(ze.location.hostname)?a:"//pencil.io"+a)}function Eb(){if(!document.cookie)return null;for(var a=document.cookie.split(/;\s*/),b=0;b<a.length;++b)if(/^login=/.test(a[b])){var c=unescape(a[b].substr(6)).split(":");if(c&&2==c.length)return{user:c[0],key:c[1]}}return null}function Fb(a,b,c,d){function e(a,b,c,d){b.getAttribute("data-loading")==a.src&&(b.removeAttribute("data-loading"),Ib(a,b,c)),d&&d()}var f,g=yb(b),b=g.href;a.setAttribute("data-loading",b),b in Ke?(f=Ke[b],null===f.queue?e(f.img,a,c,d):(f.queue.push({elem:a,css:c,cb:d}),Hb(b,a,c))):(Ke[b]=f={img:new Image,queue:[{elem:a,css:c,cb:d}]},Ab(g.hostname)&&(f.img.crossOrigin="Anonymous"),Hb(b,a,c),Gb(f.img,b,function(){var a,b=f.queue;if(f.queue=null,b)for(a=0;a<b.length;++a)e(f.img,b[a].elem,b[a].css,b[a].cb)}))}function Gb(a,b,c){function d(f){f||a.complete||a.src!=b?(a.removeEventListener("load",d),a.removeEventListener("error",d),clearTimeout(e),c()):e=setTimeout(d,100)}if(null==b&&(b=a.src),b==a.src&&(!b||a.complete))return void c();var e=null;a.addEventListener("load",d),a.addEventListener("error",d),a.src=b,d()}function Hb(a,b,c){/^data:/.test(a)&&c.width&&c.height&&Ib(null,b,c)}function Ib(b,c,d){var e,f=y(c),g=a(c),h="CANVAS"==c.tagName;if(h||(c.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),g.css({backgroundImage:"none",height:"",width:"",turtleHull:"",transformOrigin:""}),b)if("VIDEO"==b.tagName)c.width=a(b).width(),c.height=a(b).height(),h&&(e=c.getContext("2d"),e.clearRect(0,0,c.width,c.height),e.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,c.width,c.height));else if(c.width=b.width,c.height=b.height,h){if(b.width>0&&b.height>0)try{e=c.getContext("2d"),e.clearRect(0,0,b.width,b.height),e.drawImage(b,0,0)}catch(i){}}else c.src=b.src;d&&g.css(d);var j=y(c);if(b&&!d.turtleHull)try{var k=ue(b);xe(k,parseFloat(g.css("width"))/b.width,parseFloat(g.css("height"))/b.height,-j[0],-j[1]),g.css("turtleHull",k)}catch(i){}Jb(c,f,j)}function Jb(b,c,d){var e=a(b);if(e.hasClass("turtle")&&(d[0]!=c[0]||d[1]!=c[1]))if("absolute"==e.css("position")&&/px$/.test(e.css("left"))&&/px$/.test(e.css("top")))e.css("left",parseFloat(e.css("left"))+c[0]-d[0]),e.css("top",parseFloat(e.css("top"))+c[1]-d[1]);else{var f=qa(b,!0);f.tx+=c[0]-d[0],f.ty+=c[1]-d[1],b.style[Ge]=sa(f)}}function Kb(b,c,d,e,f){var g,h,i,j,k;return e===ye&&f===ye?(g=a(d),g.length?(h=g[0],i=N(h),S($(h),i)?b.filter(function(){var b=N(this);return c===(R(i,b)||!Q(i,b)&&a(this).inside(h))}):b.filter(function(){return c===a(this).inside(h)})):[]):(j=a.isNumeric(e)&&a.isNumeric(f)?[e,f]:e,a.isArray(j)&&(j=X(b[0]||document.body,[j])[0]),"touch"===d?kb(j)?b.filter(function(){return c===a(this).touches(j)}):(g=a(j),i=N(g[0]),S($(g[0]),i)?b.filter(function(){var a=N(this);return c===(!Q(i,a)&&(R(i,a)||g.touches(this)))}):b.filter(function(){return c===g.touches(this)})):(k=d*d,b.filter(function(){var a=N(this);if(O(j,k,a))return!c;if(P(j,k,a))return c;var b=Y(this),d=j.pageX-b.pageX,e=j.pageY-b.pageY;return c===k>=d*d+e*e})))}function Lb(){if(!Qe){Qe=!0;try{ze.parent.document.activeElement.blur()}catch(a){}ze.focus()}}function Mb(b,c,d,e,f){for(var g=e.split(/\s+/),h=0;h<g.length;++h){e=g[h];var i=b[e];i||(i=b[e]=a.extend({},d)),"function"!=typeof i[c]?i[c]=f:i[c]!=f&&(i[c].hooklist?i[c].hooklist.indexOf(f)<0&&i[c].hooklist.push(f):!function(){var a=[i[c],f];(i[c]=function(b,c){for(var d=b,e=0;e<a.length;++e)d=a[e](d,c)||d;return d}).hooklist=a}())}}function Nb(b,c){if(Ie.field&&"pageX"in b&&"pageY"in b){var d=a(Ie.field).offset();d&&(b.x=b.pageX-d.left,b.y=d.top-b.pageY)}return b}function Ob(a,b,c){return(Ie.field&&!Ie.fieldMouse&&this.parentElement===Ie.field||/(?:^|\s)turtle(?:\s|$)/.test(this["class"]))&&(Ie.fieldMouse=!0,Pb()),!1}function Pb(){Ie.fieldHook||Ie.surface&&Ie.fieldMouse&&(Ie.fieldHook=!0,setTimeout(function(){a("body").on("click.turtle dblclick.turtle mouseup.turtle mousedown.turtle mousemove.turtle",function(b){if(b.target===this&&!b.isTrigger){var c=a.turtle.nowarn;a.turtle.nowarn=!0;var d=a(Ie.surface).find(".turtle").within("touch",b).eq(0);if(a.turtle.nowarn=c,1===d.length)return b.target=null,b.relatedTarget=null,b.fromElement=null,b.toElement=null,d.trigger(b),!1}})},0))}function Qb(){var b="mousedown mouseup mousemove click dblclick";Mb(a.event.fixHooks,"filter",a.event.mouseHooks,b,Nb),Mb(a.event.special,"setup",{},b,Ob)}function Rb(a,b){var c=a.which;c||(c=(b||a.originalEvent).whichSynth);var d=Re[c];return!d&&c&&(d=String.fromCharCode(c)),a.key=d,a}function Sb(a,b){null!=a.charCode&&(a.key=String.fromCharCode(a.charCode))}function Tb(a){if("string"==typeof a.data){var b=a.data.replace(/\s/g,"").toLowerCase().split(","),c=a.handler,d=function(a){return b.indexOf(a.key)<0?void 0:c.apply(this,arguments)};c.guid&&(d.guid=c.guid),a.handler=d}}function Ub(){
Mb(a.event.fixHooks,"filter",a.event.keyHooks,"keydown keyup",Rb),Mb(a.event.fixHooks,"filter",a.event.keyHooks,"keypress",Sb),Mb(a.event.special,"add",{},"keydown keyup keypress",Tb)}function Vb(){return{get:function(a,b,c){return g(Xb(a).getTimbre())},set:function(a,b){Xb(a).setTimbre(f(b,"wave"))}}}function Wb(){return{get:function(a,b,c){return Xb(a).getVolume()},set:function(a,b){Xb(a).setVolume(parseFloat(b))}}}function Xb(b){var c=Ma(b);if(c.instrument)return c.instrument;c.instrument=new Xe("piano");var d=a(b);return c.instrument.on("noteon",function(b){var c=a.Event("noteon");c.midi=b.midi,d.trigger(c)}),c.instrument.on("noteoff",function(b){var c=a.Event("noteoff");c.midi=b.midi,d.trigger(c)}),c.instrument}function Yb(){return Te||(Te=new Xe),Te}function Zb(){return!(!ze.AudioContext&&!ze.webkitAudioContext)}function $b(){if($b.audioTop)return $b.audioTop;if(!Zb())return null;var a=new(ze.AudioContext||ze.webkitAudioContext);return $b.audioTop={ac:a,wavetable:hc(a),out:null,currentStart:null},_b(),$b.audioTop}function _b(){if($b.audioTop){var a=$b.audioTop;a.out&&(a.out.disconnect(),a.out=null,a.currentStart=null);var b=a.ac.createDynamicsCompressor();b.ratio=16,b.attack=5e-4,b.connect(a.ac.destination),a.out=b}}function ac(){var a=$b();return null!=a.currentStart?a.currentStart:(a.currentStart=Math.max(.25,a.ac.currentTime),setTimeout(function(){a.currentStart=null},0),a.currentStart)}function bc(a){return 440*Math.pow(2,(a-69)/12)}function cc(a){return Math.round(69+12*Math.log(a/440)/Math.LN2)}function dc(a){var b=/^(\^+|_+|=|)([A-Ga-g])([,']*)$/.exec(a);if(!b)return null;var c=b[3].replace(/,/g,"").length-b[3].replace(/'/g,"").length,d=Ue[b[2]]+Ve[b[1].charAt(0)]*b[1].length+12*c;return d+60}function ec(a){var b=(a-72)%12;(a>60||0!=b)&&(b+=12);for(var c=Math.round((a-b-60)/12),d=We[b];0!=c;)d+=c>0?"'":",",c+=c>0?-1:1;return d}function fc(a){return bc(dc(a))}function gc(a){function b(a,b){switch(a){case"V":A!==z&&c(b.split(" ")[0]);break;case"M":f(b,A);break;case"L":g(b,A);break;case"Q":h(b,A)}A.hasOwnProperty(a)?A[a]+="\n"+b:A[a]=b,"K"==a&&(B=k(b),A===z&&c(d()))}function c(a){a=a||"",(a||A===z)&&(z.voice||(z.voice={}),z.voice.hasOwnProperty(a)?(A=z.voice[a],C=A.accent):(A={id:a,accent:{slurred:0}},z.voice[a]=A,C=A.accent))}function d(){return z.V?z.V.split(/\s+/)[0]:""}function e(a){var e,f=a.match(Ze),g=null,h=0,i=0,j=null;if(!f)return null;for(;h<f.length;)if(/^[\s%]/.test(f[h]))h++;else if(/^\[[A-Za-z]:[^\]]*\]$/.test(f[h]))b(f[h].substring(1,2),f[h].substring(3,f[h].length-1).trim()),h++;else if(/</.test(f[h]))i=-f[h++].length;else if(/>/.test(f[h]))i=f[h++].length;else if(/^\(\d+(?::\d+)*/.test(f[h]))j=o(f[h++]);else if(/^[!+].*[!+]$/.test(f[h]))p(f[h++],C);else if(/^.?".*"$/.test(f[h]))h++;else if(/^[()]$/.test(f[h]))"("==f[h++]?C.slurred+=1:(C.slurred-=1,C.slurred<=0&&(C.slurred=0,A.stems&&A.stems.length>=1&&m(A.stems[A.stems.length-1],!1)));else if(/\|/.test(f[h])){for(e in C)1==e.length&&delete C[e];h++}else g=q(f,h,B,C),null!==g?(j&&(n(g.stem,j.time),j.count-=1,j.count||(j=null)),i&&A.stems&&A.stems.length&&(e=i>0?(1-Math.pow(.5,i))*g.stem.time:(Math.pow(.5,-i)-1)*A.stems[A.stems.length-1].time,l(A.stems[A.stems.length-1],e),l(g.stem,-e)),i=0,C.slurred&&m(g.stem,!0),A===z&&c(d()),"stems"in A||(A.stems=[]),A.stems.push(g.stem),h=g.index):h++}function f(a,b){var c=/^C/.test(a)?1:t(a);c&&(b.unitnote||(.75>c?b.unitnote=1/16:b.unitnote=1/8))}function g(a,b){var c=t(a);c&&(b.unitnote=c)}function h(a,b){var c,d=a.split(/\s+|=/),e=null,f=null;for(c=0;c<d.length;++c)d[c].indexOf("/")>=0||/^[1-4]$/.test(d[c])?e=e||t(d[c]):f=f||Number(d[c]);e&&(b.unitbeat=e),f&&(b.tempo=f)}function i(a){var b,c,d,e,f,g={};for(c=0;c<a.length;++c){for(b={},d=0;d<a[c].notes.length;++d)f=e=a[c].notes[d],g.hasOwnProperty(e.pitch)&&(f=g[e.pitch],f.time+=e.time,e.holdover=!0),e.tie&&(b[e.pitch]=f);g=b}}function j(a){var b,c="FCGDAEB",d={};if(!a)return d;if(a>0)for(b=0;a>b&&7>b;++b)d[c.charAt(b)]="^";else for(b=0;b>a&&b>-7;--b)d[c.charAt(6+b)]="_";return d}function k(a){if(!a)return{};var b,c={"c#":7,"f#":6,b:5,e:4,a:3,d:2,g:1,c:0,f:-1,bb:-2,eb:-3,ab:-4,db:-5,gb:-6,cb:-7,"a#m":7,"d#m":6,"g#m":5,"c#m":4,"f#m":3,bm:2,em:1,am:0,dm:-1,gm:-2,cm:-3,fm:-4,bbm:-5,ebm:-6,abm:-7,"g#mix":7,"c#mix":6,"f#mix":5,bmix:4,emix:3,amix:2,dmix:1,gmix:0,cmix:-1,fmix:-2,bbmix:-3,ebmix:-4,abmix:-5,dbmix:-6,gbmix:-7,"d#dor":7,"g#dor":6,"c#dor":5,"f#dor":4,bdor:3,edor:2,ador:1,ddor:0,gdor:-1,cdor:-2,fdor:-3,bbdor:-4,ebdor:-5,abdor:-6,dbdor:-7,"e#phr":7,"a#phr":6,"d#phr":5,"g#phr":4,"c#phr":3,"f#phr":2,bphr:1,ephr:0,aphr:-1,dphr:-2,gphr:-3,cphr:-4,fphr:-5,bbphr:-6,ebphr:-7,"f#lyd":7,blyd:6,elyd:5,alyd:4,dlyd:3,glyd:2,clyd:1,flyd:0,bblyd:-1,eblyd:-2,ablyd:-3,dblyd:-4,gblyd:-5,cblyd:-6,fblyd:-7,"b#loc":7,"e#loc":6,"a#loc":5,"d#loc":4,"g#loc":3,"c#loc":2,"f#loc":1,bloc:0,eloc:-1,aloc:-2,dloc:-3,gloc:-4,cloc:-5,floc:-6,bbloc:-7},d=a.replace(/\s+/g,"").toLowerCase().substr(0,5),e=d.match(/maj|min|mix|dor|phr|lyd|loc|m/);b=e?"maj"==e?d.substr(0,e.index):"min"==e?d.substr(0,e.index+1):d.substr(0,e.index+e[0].length):/^[a-g][#b]?/.exec(d)||"";var f=j(c[b]),g=a.substr(b.length).match(/(_+|=|\^+)[a-g]/gi);if(g)for(var h=0;h<g.length;++h){var i=g[h].charAt(g[h].length-1).toUpperCase();"="==g[h].charAt(0)?delete f[i]:f[i]=g[h].substr(0,g[h].length-1)}return f}function l(a,b){var c,d,e=a.time,f=e+b;for(a.time=f,c=0;c<a.notes.length;++c)d=a.notes[c],d.time==e&&(d.time=f)}function m(a,b){var c,d;for(c=0;c<a.notes.length;++c)d=a.notes[c],b?d.slurred=!0:d.slurred&&delete d.slurred}function n(a,b){var c;for(a.time*=b,c=0;c<a.notes.length;++c)a.notes[c].time*=b}function o(a){var b=/^\((\d+)(?::(\d+)(?::(\d+))?)?$/.exec(a);if(!b)return null;var c=Number(b[1]),d=Number(b[2])||2,e=Number(b[3])||c;return{time:d/c,count:e}}function p(a,b){if(!(a.length<2))switch(a=a.substring(1,a.length-1)){case"pppp":case"ppp":b.dynamics=.2;break;case"pp":b.dynamics=.4;break;case"p":b.dynamics=.6;break;case"mp":b.dynamics=.8;break;case"mf":b.dynamics=1;break;case"f":b.dynamics=1.2;break;case"ff":b.dynamics=1.4;break;case"fff":case"ffff":b.dynamics=1.5}}function q(a,b,c,d){var e,f,g,h,i=[],j="",k=!1,l=null,m=1/0;if(b<a.length&&"."==a[b]&&(k=!0,b++),b<a.length&&"["==a[b]){for(b++;b<a.length;)if(/^[\s%]/.test(a[b]))b++;else{if(/[A-Ga-g]/.test(a[b]))l={pitch:s(a[b++],c,d),tie:!1},l.frequency=fc(l.pitch),i.push(l);else{if(!/[xzXZ]/.test(a[b])){if("."==a[b]){k=!0,b++;continue}break}l=null,b++}b<a.length&&/^(?![\s%!]).*[\d\/]/.test(a[b])?(e=a[b++],f=t(e)):(e="",f=1),l&&(l.duration=e,l.time=f),f&&m>f&&(j=e,m=f),b<a.length&&"-"==a[b]&&(l&&(i[i.length-1].tie=!0),b++)}if("]"!=a[b])return null;b++}else if(b<a.length&&/[A-Ga-g]/.test(a[b]))l={pitch:s(a[b++],c,d),tie:!1,duration:"",time:1},l.frequency=fc(l.pitch),i.push(l);else{if(!(b<a.length&&/^[xzXZ]$/.test(a[b])))return null;b++}if(b<a.length&&/^(?![\s%!]).*[\d\/]/.test(a[b]))for(j=a[b++],f=t(j),h=0;h<i.length;++h)i[h].duration=j,i[h].time=f;if(b<a.length&&"-"==a[b])for(b++,h=0;h<i.length;++h)i[h].tie=!0;if(d.dynamics)for(g=d.dynamics,h=0;h<i.length;++h)i[h].velocity=g;return{index:b,stem:{notes:i,duration:j,staccato:k,time:t(j)}}}function r(a){return a.length>0&&"="==a.charAt(0)?a.substr(1):a}function s(a,b,c){var d,e=/^(\^+|_+|=|)([A-Ga-g])(.*)$/.exec(a);return e?(d=e[2].toUpperCase(),e[1].length>0?(c[d]=e[1],r(a)):r(c.hasOwnProperty(d)?c[d]+e[2]+e[3]:b.hasOwnProperty(d)?b[d]+e[2]+e[3]:a)):a}function t(a){var b,c,d,e=/^(\d*)(?:\/(\d*))?$|^(\/+)$/.exec(a),f=0;if(e){if(e[3])return Math.pow(.5,e[3].length);if(c=e[2]?parseFloat(e[2]):/\//.test(a)?2:1,d=0,b=e[1]?parseFloat(e[1]):1,e[2])for(;d+1<e[1].length&&b>c;)d+=1,f=parseFloat(e[1].substring(0,d)),b=parseFloat(e[1].substring(d));return f+b/c}}var u,v,w,x,y=a.split("\n"),z={},A=z,B={},C={slurred:0};for(u=0;u<y.length;++u)if(w=Ye.exec(y[u]))b(w[1],w[2].trim());else{if(/^\s*(?:%.*)?$/.test(y[u]))continue;e(y[u])}var D=["unitnote","unitbeat","tempo"];if(z.voice){x=[];for(u in z.voice)if(z.voice[u].stems&&z.voice[u].stems.length){for(i(z.voice[u].stems),v=0;v<D.length;++v)!(D[v]in z)&&D[v]in z.voice[u]&&(z[D[v]]=z.voice[u][D[v]]);delete z.voice[u].accent}else x.push(u);for(u=0;u<x.length;++u)delete z.voice[x[u]]}return z}function hc(a){return function(b){function c(b){var c,d=b.real.length,e=new Float32Array(d),f=new Float32Array(d);for(c=0;d>c;++c)e[c]=b.real[c],f[c]=b.imag[c];try{return a.createPeriodicWave(e,f)}catch(g){}try{return a.createWaveTable(e,f)}catch(g){}return null}function d(a,b,c){var d,e,f={real:[],imag:[]},g=a.real.length;for(d=0;g>d;++d)e=Math.log(b[Math.min(d,b.length-1)]),f.real.push(a.real[d]*Math.exp(c*e)),f.imag.push(a.imag[d]*Math.exp(c*e));return f}var e,f,g,h,i,j,k={};for(e in b)if(f=b[e],j=c(f)){if(i={wave:j},f.mult)for(h=b[e].freq,i.freq={},g=0;g<h.length;++g)j=c(d(f,f.mult,(g+1)/h.length)),j&&(i.freq[h[g]]=j);f.defs&&(i.defs=f.defs),k[e]=i}return k}({piano:{real:[0,0,-.203569,.5,-.401676,.137128,-.104117,.115965,-.004413,.067884,-.00888,.0793,-.038756,.011882,-.030883,.027608,-.013429,.00393,-.014029,.00972,-.007653,.007866,-.032029,.046127,-.024155,.023095,-.005522,.004511,-.003593,.011248,-.004919,.008505],imag:[0,.147621,0,7e-6,-1e-5,5e-6,-6e-6,9e-6,0,8e-6,-1e-6,14e-6,-8e-6,3e-6,-9e-6,9e-6,-5e-6,2e-6,-7e-6,5e-6,-5e-6,5e-6,-23e-6,37e-6,-21e-6,22e-6,-6e-6,5e-6,-4e-6,14e-6,-7e-6,12e-6],mult:[1,1,.18,.016,.01,.01,.01,.004,.014,.02,.014,.004,.002,1e-5],freq:[65,80,100,135,180,240,620,1360],defs:{wave:"piano",gain:.5,attack:.002,decay:.25,sustain:.03,release:.1,decayfollow:.7,cutoff:800,cutfollow:.1,resonance:1,detune:.9994}}})}function ic(b){var c,d,e=[],f=b.length;for(f&&a.isFunction(b[f-1])&&(d=b[--f]),c=0;f>c;++c)b[c]&&(b[c].constructor===a?e.push.apply(e,b[c].toArray()):a.isArray(b[c])?e.push.apply(e,b[c]):e.push(b[c]));return{elts:a.unique(e),completion:d}}function jc(){function b(){var a,b=g;for(g=null,f&&f(),a=0;a<b.length;++a)b[a]()}var c,d=ic(arguments),e=d.elts,f=d.completion,g=[];if(e.length>1)for(c=0;c<e.length;++c)Lc(e[c]),a(e[c]).queue(function(a){g&&(g.push(a),g.length==e.length&&b())})}function kc(){var b,c=ic(arguments),d=c.elts,e=c.completion,f=d.length;for(b=0;b<d.length;++b)a(d[b]).queue(function(b){a(this).remove(),f-=1,e&&0==f&&e(),b()})}function lc(a){If.html('<aside style="line-height:133%;word-break:normal;white-space:normal">'+a+"</aside>")}function mc(b){var c,d,e=a.extend({},jf,$e,kf);if(b&&!a.isArray(b.helptext)&&b in e&&(b=e[b]),b&&a.isArray(b.helptext)&&b.helptext.length){for(d=0;d<b.helptext.length;++d){var f=b.helptext[d];lc(f.replace(/<(u)>/g,'<$1 style="border:1px solid black;text-decoration:none;word-break:keep-all;white-space:nowrap">').replace(/<(mark)>/g,'<$1 style="border:1px solid blue;color:blue;text-decoration:none;word-break:keep-all;white-space:nowrap;cursor:pointer;" onclick="see.enter($(this).text())">'))}return mf}if("number"==typeof b)return lc("Equal to the number "+b+"."),mf;if("boolean"==typeof b)return lc("Equal to the boolean value "+b+"."),mf;if(null===b)return lc("The special null value represents the absence of a value."),mf;if(b===ye)return lc("This is an unassigned value."),mf;if(b===ze)return lc("The global window object represents the browser window."),mf;if(b===document)return lc("The HTML document running the program."),mf;if(b===jQuery)return lc('The jQuery function.  Read about it at <a href="http://learn.jquery.com/" target="_blank">jquery.com</a>.'),mf;if(b&&b!=mc)return lc("No help available for "+b),mf;c=[];for(var g in e)!e[g].helptext||!e[g].helptext.length||g in ze&&"function"!=typeof ze[g]||c.push(g);return c.sort(function(a,b){return a.length!=b.length?a.length-b.length:b>a?-1:a>b?1:0}),lc("help available for: "+c.map(function(a){return'<mark style="border:1px solid blue;color:blue;text-decoration:none;word-break:keep-all;white-space:nowrap;cursor:pointer;" onclick="see.enter($(this).text())">'+a+"</mark>"}).join(" ")),mf}function nc(a){return 1==a.length&&oc(a[0])&&a[0]}function oc(b){var c;return b&&0==a.queue(b).length&&(0===(c=nb(b))||0===a.fx.speeds[c])}function pc(b,c){var d;if(null==c){if(oc(b))return;d=nb(b)}else d=1e3*c;var e=a(b);d>0&&e.delay(d)}function qc(a,b){if(b=b||0,a.length<=b)return null;var c=a[a.length-1];return"function"!=typeof c||c.helpname?null:c}function rc(b,c,d,e){function f(d,e){if(null!=d){var f=b&&b[d];e&&f&&_a(f,a.data(f,"turtleData"),!0),xf.reportEvent("resolve",[c,m,j,d,f])}0==--k&&h&&(l?(De+=1,setTimeout(function(){De-=1,h()},0)):h())}function g(a){null!=a&&xf.reportEvent("appear",[c,m,j,a,b&&b[a],i])}var h=qc(d,e),i=h?Array.prototype.slice.call(d,0,d.length-1):d,j=b?b.length||0:0,k=j+1,l=!0,m=xf.nextId();return xf.reportEvent("enter",[c,m,j,i]),{name:c,args:i,appear:g,resolve:f,resolver:function(a,b){return function(){f(a,b)}},exit:function(){xf.reportEvent("exit",[c,m,j,i]),f(null),l=!1}}}function sc(b,c,d,e){var f=function(){if(Mc(b),Ce)throw new Error(b+" interrupted");var d,f=rc(this,b,arguments,c),g=[f].concat(a.makeArray(f.args));try{d=e.apply(this,g)}finally{f.exit()}return d};return xc(b,d,f)}function tc(a,b,c){var d=function(){if(Mc(a),Ce)throw new Error(a+" interrupted");return Nc(a,this),c.apply(this,arguments)};return xc(a,b,d)}function uc(b,c,d,e){var f=function(){if(Mc(b),Ce)throw new Error(b+" interrupted");var c=null,f=0,g=ff;if(e&&(c=e.apply(null,arguments),f=arguments.length,g=Pc()),g){var h=a(ff).eq(0),i=arguments,j=rc(h,b,arguments,f);h.plan(function(a,b){j.appear(a),d.apply(c,i),this.plan(j.resolver(a))}),j.exit()}else j=rc(null,b,arguments,f),d.apply(c,arguments),j.exit();return c?c.result:void 0};return xc(b,c,f)}function vc(b,c){return xc(b,c,function(c,d){var e=/^key/.test(b),f=/^mouse|click$/.test(b),g=f?"input,button":e?"textarea,input:not([type]),input[type=text],input[type=password]":null;e&&Lb(),null==d&&"function"==typeof c&&(d=c,c=null),a(ze).on(b+".turtleevent",null,c,g?function(b){return Ce||a(b.target).closest(g).length?void 0:d.apply(this,arguments)}:d)})}function wc(){var b=a._data(ze,"events");if(!b)return!1;for(var c in b)for(var d=b[c],e=0;e<d.length;++e)if("turtleevent"==d[e].namespace)return!0;return!1}function xc(a,b,c){return c.helpname=a,c.helptext=b,c}function yc(a,b,c){b=null==b?90:wa(b);var d,e="lt"===a.name,f=uf;if((d=nc(this))&&(0===c||null==c&&0===Na(d)))return a.appear(0),ib(d,e?-b:b),a.resolve(0),this;var g=e?"-=":"+=";return null==c?(this.plan(function(c,d){a.appear(c),this.animate({turtleRotation:g+ra(b||0)+"deg"},nb(d,f),ob(d),a.resolver(c))}),this):(this.plan(function(d,h){a.appear(d);var i=Ma(h),j=i.turningRadius,k=0>b?-c:c,l=null;i.style&&i.down&&(l=function(){var a=Y(h),c=qa(h,!0),d=z(h.parentElement);return function(){sb(i.corners[0],a,c.rot,c.rot+(e?-b:b),k*c.sy,d)}}()),i.turningRadius=k,this.animate({turtleRotation:g+ra(b)+"deg"},nb(h,f),ob(h)),this.plan(function(){l&&l(),i.turningRadius=j,a.resolve(d,!0)})}),this)}function zc(a,b){null==b&&(b=100),"bk"===a.name&&(b=-b);var c,d=uf;return(c=nc(this))?(a.appear(0),gb(c,b,0),a.resolve(0,!0),this):(this.plan(function(c,e){a.appear(c),this.animate({turtleForward:"+="+ra(b||0)+"px"},nb(e,d),ob(e),a.resolver(c,!0))}),this)}function Ac(b,c,d){a.isArray(c)&&(d=c[1],c=c[0]),d||(d=0),c||(c=0);var e=uf;return this.plan(function(a,f){b&&b.appear(a),this.animate({turtlePosition:jb(f,d,c)},nb(f,e),ob(f),b&&b.resolver(a,!0))}),this}function Bc(b,c,d){a.isArray(c)&&(d=c[1],c=c[0]),d||(d=0),c||(c=0);var e,f=uf;return(e=nc(this))?(b&&b.appear(0),hb(e,c,d),b&&b.resolve(0),this):(this.plan(function(a,e){b&&b.appear(a);var g=w(e);this.animate({turtlePosition:ra(g[0]+c)+" "+ra(g[1]-d)},nb(e,f),ob(e),b&&b.resolver(a,!0))}),this)}function Cc(b,c,d){var e=c,f=0,g=0,h=null,i=uf;return a.isNumeric(e)&&a.isNumeric(d)?(f=parseFloat(e),g=parseFloat(d),e=null,h=null):a.isArray(e)?(f=e[0],g=e[1],e=null,h=d):a.isNumeric(d)&&(h=d),this.plan(function(c,d){var j=e;if(null===j&&(j=a(V(d)).pagexy()),j&&!kb(j))try{j=a(j).pagexy()}catch(k){return}return j&&kb(j)?a.isWindow(d)?(b&&b.appear(c),aa(j,h),void(b&&b.resolve(c))):void(9!==d.nodeType&&(b&&b.appear(c),this.animate({turtlePosition:U(d,j,h,f,g)},nb(d,i),ob(d),b&&b.resolver(c,!0)))):void 0}),this}function Dc(a){return function(b,c,d){return this.plan(function(e,f){b.appear(e);var g=this.css("turtlePenDown");this.css({turtlePenDown:"up"}),a.call(this,null,c,d),this.plan(function(){this.css({turtlePenDown:g}),b.resolve(e,!0)})}),this}}function Ec(b){var c=uf;return function(d,e,f){if(a.isNumeric(e)){var g=e;e=f,f=g}return null==f&&(f=8.8),this.plan(function(g,h){var i=Ma(h),j=i.style;e||(e=j&&(j.fillStyle||j.strokeStyle)||"black"),d.appear(g);var k=this.pagexy(),l=qa(h,!0),m=Ia(e,"fillStyle"),n=Ba(i),o=f*l.sx,p=Math.max(0,o-2),q=o+(m.eraseMode?2:0),r=/rgba|hsla/.test(m.fillStyle);null==m.lineWidth&&j&&j.lineWidth&&(m.lineWidth=j.lineWidth),nc(this)?(b(n,k,q,l.rot,m,!0),d.resolve(g)):this.queue(function(e){a({radius:0}).animate({radius:p},{duration:nb(h,c),step:function(){r||b(n,k,this.radius,l.rot,m,!1)},complete:function(){b(n,k,q,l.rot,m,!0),d.resolve(g),e()}})})}),this}}function Fc(a,b,c,d,e){var f=a.getContext("2d");f.save(),Va(f,e),c===1/0?(f.setTransform(1,0,0,1,0,0),f.fillRect(0,0,a.width,a.height)):(Xa(f,a),f.beginPath(),f.arc(b.pageX,b.pageY,c/2,0,2*Math.PI,!1),f.closePath(),f.fill(),e.strokeStyle&&f.stroke()),f.restore()}function Gc(a,b,c,d,e){var f=a.getContext("2d");if(f.save(),Va(f,e),c===1/0)f.setTransform(1,0,0,1,0,0),f.fillRect(0,0,a.width,a.height);else{var g=Math.sin((d+45)/180*Math.PI),h=Math.cos((d+45)/180*Math.PI),i=c*h/Math.SQRT2,j=c*g/Math.SQRT2;Xa(f,a),f.beginPath(),f.moveTo(b.pageX-i,b.pageY-j),f.lineTo(b.pageX-j,b.pageY+i),f.lineTo(b.pageX+i,b.pageY+j),f.lineTo(b.pageX+j,b.pageY-i),f.closePath(),f.fill(),e.strokeStyle&&f.stroke()}f.restore()}function Hc(a,b,c,d,e,f){var g=a.getContext("2d");if(g.save(),Va(g,e),!e.strokeStyle&&e.fillStyle&&(g.strokeStyle=e.fillStyle),c!==1/0){var h=Math.sin(d/180*Math.PI),i=-Math.cos(d/180*Math.PI),j=e.lineWidth||1.62,k=b.pageX+c*h,l=b.pageY+c*i,m=Ic(j,k,l,h,i),n=c-m.hs,o=n*h,p=n*i;Xa(g,a),n>0&&(g.beginPath(),g.moveTo(b.pageX,b.pageY),g.lineTo(b.pageX+o,b.pageY+p),g.stroke()),f&&Jc(g,m)}g.restore()}function Ic(a,b,c,d,e){var f=Math.max(1.25*a,a+2),g=2*f,h=g-f/2;return{hs:h,x1:b,y1:c,xm:b-d*h,ym:c-e*h,x2:b-e*f-d*g,y2:c+d*f-e*g,x3:b+e*f-d*g,y3:c-d*f-e*g}}function Jc(a,b){a.beginPath(),a.moveTo(b.x2,b.y2),a.lineTo(b.x1,b.y1),a.lineTo(b.x3,b.y3),a.quadraticCurveTo(b.xm,b.ym,b.x2,b.y2),a.closePath(),a.fill()}function Kc(a,b,c,d,e,f){var g=e-c,h=f-d,i=Math.sqrt(g*g+h*h),j=g/i,k=h/i,l=Ic(b,e,f,j,k);i>l.hs&&(a.beginPath(),a.moveTo(c,d),a.lineTo(l.xm,l.ym),a.lineWidth=b,a.stroke()),Jc(a,l)}function Lc(c,d){if(d||(d="fx"),"IMG"==c.tagName&&c.src&&!c.complete){var e=a.queue(c,d);0==e.length&&(a.queue(c,d,function(a){Gb(c,null,a)}),b(c,d))}}function Mc(b){if(!(a.turtle.hangtime==1/0||af++<100)){af=0;var c=(new Date).getTime();return cf?void(c-cf>a.turtle.hangtime&&(If.visible()&&If.html('<span style="color:red">Oops: program interrupted because it was hanging the browser. Try reducing the number of repetitions.  Or try using <b style="background:yellow">await done defer()</b> or <b style="background:yellow">tick</b> to make an animation.</span>'),a.turtle.interrupt("hung"))):(cf=c,clearTimeout(bf),void(bf=setTimeout(function(){clearTimeout(bf),bf=null,cf=null},0)))}}function Nc(b,c){if(!a.turtle.nowarn){var d,e=!0;for(d=0;e&&d<c.length;++d)a.queue(c[d]).length>=100&&(e=!1);e||(_e[b]||(_e[b]=1,If.visible()?If.html('<span style="color:red">Oops: '+b+' may not return useful results when motion is queued. Try <b style="background:yellow">speed Infinity</b></span> or <b style="background:yellow">await done defer()</b> first.'):console.warn(b+' may not return useful results when motion is queued.  Try "speed Infinity" or "await done defer()".')),c.finish())}}function Oc(a,b,d){a[b]=function(){return b in _e||(If.html('<span style="color:red;">'+b+" deprecated.  Use "+d+".</span>"),_e[b]=1),a[d].apply(this,arguments)},a[d].__super__&&c(a[b],a[d])}function Pc(){return ff&&a.queue(ff).length>0}function Qc(a){if(null===lf.pollTimer){var b=lf.sent[a],c=lf.waiting[a];c&&c.length&&b&&b.length&&(lf.pollTimer=setTimeout(function(){lf.pollTimer=null,c&&c.length&&b&&b.length&&(c.shift().apply(null,b.shift()),Qc(a))},0))}}function Rc(a,b){if("function"!=typeof b&&"undefined"!=typeof b||!/^\w+\s*$/.test(a)){if("undefined"==typeof b&&/^help\s+\S+$/.test(a))return mc(/^help\s+(\S+)$/.exec(a)[1]),!0}else{if(b&&b.helptext)return mc(b),!0;if(a in kf)return mc(a),!0}return!1}function Sc(a,b,c,d){return a.helptext?d.helptext=a.helptext:b in c&&(d.helptext=c[b].helptext),d.method=a,d.helpname=b,d}function Tc(a,b){var c=[];for(var d in b)!b.hasOwnProperty(d)||d in ze||(c.push(d),ze[d]=function(b){var c=a[b],d=a;return Sc(c,b,kf,function(){return c.apply(d,arguments)})}(d));return c}function Uc(){ff=null;for(var a=0;a<gf.length;++a)delete ze[gf[a]];gf.length=0}function Vc(a){return null!==Xc(a)}function Wc(a){if(!/^[a-z]+$/.test(a))return!1;for(var b=0;b<nf.length;++b)if(nf[b]==a)return!0;return!1}function Xc(b){if(b in of)return of[b];if(!b||!Wc(b)&&!/^(?:rgb|hsl)a?\([^)]*\)$|^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/i.test(b))return null;var c,d=document.createElement("div"),e=d.style.color,f=null;return d.style.color=b,e!==d.style.color&&(c=/rgba?\s*\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*([.\d]+))?\s*\)/.exec(a(d).css({position:"absolute",top:0,left:0}).appendTo("body").css("color")),c?f=[parseInt(c[1]),parseInt(c[2]),parseInt(c[3]),Math.round(255*(c[4]?parseFloat(c[4]):1))]:"transparent"==b&&(f=[0,0,0,0]),a(d).remove()),of[b]=f,f}function Yc(a){var b=Ea(40,48),c=b.getContext("2d"),d=20,e=26;c.beginPath(),c.arc(d,e,16,0,2*Math.PI,!1),c.closePath(),c.fillStyle=a,c.fill(),c.beginPath();for(var f=[[[5,-14],[3,-11]],[[3,-11],[7,-8],[4,-4]],[[4,-4],[7,0],[4,4]],[[4,4],[7,8],[3,11]],[[7,-8],[12,-9],null],[[7,0],[15,0],null],[[7,8],[12,9],null],[[3,11],[1,15],null]],g=0;g<f.length;g++){var h=f[g];c.moveTo(d+h[0][0],e+h[0][1]);for(var i=1;i<h.length;i++)null!==h[i]&&c.lineTo(d+h[i][0],e+h[i][1]);for(var i=h.length-1;i>=0;i--)null===h[i]?(i--,c.moveTo(d-h[i][0],e+h[i][1])):c.lineTo(d-h[i][0],e+h[i][1])}return c.lineWidth=1.1,c.strokeStyle="rgba(255,255,255,0.75)",c.stroke(),c.beginPath(),c.arc(d,e,15.5,0,2*Math.PI,!1),c.closePath(),c.strokeStyle="rgba(0,0,0,0.4)",c.stroke(),b.toDataURL()}function Zc(a){var b=Ea(40,48),c=b.getContext("2d");return c.beginPath(),c.moveTo(0,48),c.lineTo(20,0),c.lineTo(40,48),c.lineTo(20,36),c.closePath(),c.fillStyle=a,c.fill(),b.toDataURL()}function $c(a){var b=Ea(40,40),c=b.getContext("2d");return c.beginPath(),c.arc(20,20,18,-5*Math.PI/2,-Math.PI/2),c.closePath(),c.lineTo(20,20),c.stroke(),c.strokeStyle=a,c.lineWidth=4,c.stroke(),b.toDataURL()}function _c(a,b){b=b||12;var c=Ea(b,b),d=c.getContext("2d"),e=b/2;return d.beginPath(),d.arc(e,e,e,0,2*Math.PI),d.closePath(),d.fillStyle=a,d.fill(),c.toDataURL()}function ad(a){function b(){e.moveTo(19.5,43),e.lineTo(20.5,43),e.lineTo(21.5,43.5),e.lineTo(25.5,36.2),e.lineTo(24,35.5),e.lineTo(23,35.5),e.lineTo(20.5,36.5),e.lineTo(19.5,36.5),e.lineTo(17,35.5),e.lineTo(16,35.5),e.lineTo(14.5,36.2),e.lineTo(18.5,43.5),e.closePath()}function c(){e.moveTo(25.5,12),e.lineTo(25.5,8),e.lineTo(14.5,8),e.lineTo(14.5,12),e.closePath()}var d=Ea(40,48),e=d.getContext("2d");return e.beginPath(),b(),e.fillStyle="#ffcb6b",e.fill(),e.beginPath(),c(),e.fillStyle="#d1ebff",e.fill(),e.beginPath(),e.moveTo(19.5,48),e.lineTo(13,36),e.lineTo(13,1),e.lineTo(14,0),e.lineTo(26,0),e.lineTo(27,1),e.lineTo(27,36),e.lineTo(20.5,48),e.closePath(),b(),e.moveTo(25.5,12),e.lineTo(25.5,8),e.lineTo(14.5,8),e.lineTo(14.5,12),e.closePath(),e.fillStyle=a,e.fill(),d.toDataURL()}function bd(a,b,c){return c||(c=1),function(d){var e=document.createElement("canvas");e.width=a,e.height=b;var f=e.getContext("2d");d||(d="rgba(128,128,128,0.125)"),"transparent"!=d&&(f.fillStyle=d,f.fillRect(0,0,a,b));var g=a/c,h=b/c,i={width:g,height:h,transformOrigin:g/2+"px + "+h/2+"px",opacity:1};return 1>c&&(i.imageRendering="pixelated"),{img:e,css:i}}}function cd(a){if(!a)return null;if(a in pf)return pf[a];var b=a.match(/^(\d+)x(\d+)(?:\/(\d+))?$/);return b?bd(parseFloat(b[1]),parseFloat(b[2]),b[3]&&parseFloat(b[3])):null}function dd(a,b){var c=a.width||a.height||256,d=a.height||a.width||256,e=a.subpixel||1/(a.scale||1),f=a.color||"transparent",g=bd(c,d,e);return g(f)}function ed(b,c){if(!b)return null;if(a.isPlainObject(b))return dd(b,c);if(a.isFunction(b)&&(b.helpname||b.name)&&(b=b.helpname||b.name),b.constructor===a){if(!b.length)return null;b=b.get(0)}if(b.tagName)return"CANVAS"!=b.tagName&&"IMG"!=b.tagName&&"VIDEO"!=b.tagName?null:{img:b,css:{opacity:1}};var d=b.toString().trim().split(/\s+/),e=null,f=null;if(d.length&&(f=cd(d[d.length-1]),f&&d.pop()),d.length&&Vc(d.join(" "))&&(e=d.join(" "),d.length=0),!f&&e&&(f=cd(c)),f)return f(e);if(/\//.test(b)){var g=yb(b).hostname;return!Ab(g)&&Ab(ze.location.hostname)&&(b=ze.location.protocol+"//"+ze.location.host+"/proxy/"+zb(b)),{url:b,css:{transformOrigin:"50% 50%",opacity:1}}}return null}function fd(a){return null==a?"":String(a).replace(/[&<>"]/g,function(a){return qf[a]})}function gd(b,c,d){var e=b&&/^[a-zA-Z]\w*$/.exec(b),f=b&&/^<.*>$/.exec(b),g=ed(b,d)||null==b&&ed(d);e&&a("#"+b).length&&(e=!1);var h;g?(h=a("<canvas>"),fb(h,g)):h=a(f?b:"<div>"+fd(b)+"</div>"),b&&"object"==typeof b&&("id"in b&&h.attr("id",b.id),"class"in b&&h.addClass(b["class"])),h.css({position:"absolute",display:"table",top:0,left:0}),(!c||9==c.nodeType||a.isWindow(c))&&(c=xa()),h.appendTo(c);var i=y(h[0]);return h.css({top:-i[1],left:-i[0]}),h.css({turtlePosition:U(h[0],a(c).pagexy(),null,0,0),turtleRotation:0,turtleScale:1}),h.addClass("turtle"),e&&(h.attr("id",b),hf&&!ze.hasOwnProperty(b)&&(ze[b]=h)),h}function hd(a,b){if("number"==typeof a)return a=Math.ceil(a),"number"==typeof b?(b=Math.ceil(b),Math.floor(Math.random()*(b-a)+a)):Math.floor(Math.random()*a);if("object"==typeof a&&a&&a.length&&a.slice)return a[Math.floor(Math.random()*a.length)];if("normal"==a){var c,d,e,f,g;do c=Math.random(),d=1.7156*(Math.random()-.5),e=c-.449871,f=Math.abs(d)+.386595,g=e*e+f*(.196*f-.25472*e);while(g>.27597&&(g>.27846||d*d>-4*Math.log(c)*c*c));return d/c}return"position"==a?{pageX:hd(K()+1),pageY:hd(J()+1)}:"color"==a?"hsl("+Math.floor(360*Math.random())+",100%,50%)":"gray"==a?"hsl(0,0,"+Math.floor(100*Math.random())+"%)":a===!0?Math.random()>=.5:Math.random()}function id(b,c){c||"function"!=typeof b||(c=b,b=30);var d=null,e=Math.max(Math.floor(1e3/Math.max(1/86400,b)),0);if(Pc()){var f=a(ff);f.plan(function(){d=c})}else d=c;var g={fn:c,timer:setInterval(function(){if(d)try{uf++,sf.push(g),d()}finally{uf--,sf.pop(g)}},e)};return rf.push(g),g.timer}function jd(a){for(var b=[],c=0;c<rf.length;++c){var d=rf[c];null==a||a==d.timer||a==d.fn?clearInterval(rf[c].timer):b.push(rf[c])}rf=b}function kd(a){null==a&&sf.length&&(a=sf[sf.length-1].timer),jd(a)}function ld(b,c){c===ye&&a.isFunction(b)&&(c=b,b=1),tf&&(ze.clearInterval(tf),tf=null),c&&b&&(tf=ze.setInterval(function(){try{uf++,c()}finally{uf--}},1e3/b))}function md(b){return b===ye?1e3/a.fx.speeds.turtle:void(a.fx.speeds.turtle=b>0?1e3/b:0)}function nd(b){b===ye&&(b=""),a("[id]").each(function(c,d){ze[b+d.id]=a("#"+d.id)}),hf=!0}function od(b){if(b===ye&&(b="last"),vf&&a(ze).off(a.map(ef,function(a,b){return b}).join(" "),vf),b||""===b){vf=function(a){var c,d,e,f,g=[b+a.type];for((a.originalEvent||a)instanceof MouseEvent&&g.push(b+"mouse"),c=0;c<g.length;++c){var e=g[c];if(d=ze[e],d&&d.__proto__===a.__proto__){for(f in d)d.hasOwnProperty(f)&&delete d[f];for(f in a)a.hasOwnProperty(f)&&(d[f]=a[f])}else ze[e]=a}},ze[b+"mouse"]=new a.Event;for(var c in ef)ze[b+c]=new a.Event;a(ze).on(a.map(ef,function(a,b){return b}).join(" "),vf)}}function pd(b){var c=10,d=qd(),e=a(ze).height()+a(ze).scrollTop()+c>=a("html").outerHeight(!0);if(b(),e){var f=a(ze).scrollTop(),g=Math.min(d,a("html").outerHeight(!0)-a(ze).height());g>f&&a(ze).scrollTop(g)}}function qd(){if(!wf.timer){wf.timer=setTimeout(function(){wf.timer=null},0);var b=a("body").offset(),c=b?b.top:8;wf.bottomSeen=Math.min(a(ze).height()+a(ze).scrollTop(),a("body").height()+c)}return wf.bottomSeen}function rd(b){var c=a(ze).scrollTop();b(),a(ze).scrollTop(c)}function sd(){var a=document.body.lastChild;return a&&"PRE"==a.tagName||(a=document.createElement("pre"),document.body.appendChild(a)),a}function td(){var a=arguments;pd(function(){for(var b=sd(),c=0;c<a.length;c++)b.appendChild(document.createTextNode(String(a[c])))})}function ud(b,c){var d=a("<div>").css({display:"inline-block",verticalAlign:"top",textAlign:"center",height:"1.2em",width:"1.2em",maxWidth:"1.2em",overflow:"hidden"}).appendTo(sd()),e=function(){b&&d.css({background:b}),c&&d.text(c)};if(ff){var f=a(ff);Cc.call(f,null,d),f.eq(0).plan(e)}else e()}function vd(){var a=this;pd(function(){a.result.appendTo("body"),a.setup&&a.setup()})}function wd(b,c){var d="<"+c+' style="display:table">',e="</"+c+">";if(b===ye||null===b)return{result:a(d+"<br>"+e)};var f=null;return b=""+b,/^\s*<.*>\s*$/.test(b)&&(f=a(b)),(null==f||1!=f.length||1!=f[0].nodeType)&&(f=a(d+b+e)),{result:f}}function xd(b,c){function d(b){return function(d){j||m&&"change"==d.type||(j=!0,a(this).prop("checked",!0),i.find("input[type=radio]").prop("disabled",!0),c(b))}}function e(a){return function(){j||(l=a,f())}}function f(a){a||(m+=1,setTimeout(function(){m-=1},0),i.find("input").eq(l).prop("checked",!0)),i.find("input").eq(l).focus()}function g(b,c){a.isFunction(b)&&(b=(k+1).toString());var f=a.isFunction(c)||null==c?b:c,g=a('<input type="radio" name="menu" class="turtleinput">').attr("value",f).on("change click",d(c)),h=a('<label style="display:table">').append(g).append(b).on("click",d(c)).on("mousedown",e(k)),j=b&&b.toString().substr(0,1).toUpperCase();!j||j in n||(n[j]=k),k+=1,i.append(h)}var h,i=a("<form>").css({display:"table",marginLeft:"20px"}).submit(function(){return!1}),j=!1,k=0,l=0,m=0,n={};if(c||(c=function(b){a.isFunction(b)&&b.call(null)}),a.isArray(b))for(var o=0;o<b.length;++o)g(b[o],b[o]);else if(a.isPlainObject(b))for(h in b)g(h,b[h]);else g(b,b);return i.on("keydown",function(a){if(a.which>=37&&a.which<=40||32==a.which){var b=i.find("input").index(i.find(":checked"));return l=b>=0&&l!=b?b:0>b?0:a.which>=39||32==a.which?(l+1)%k:(l+k-1)%k,f(),!1}13==a.which?i.find(":checked").click():String.fromCharCode(a.which)in n&&(l=n[String.fromCharCode(a.which)],f())}),{result:i,setup:function(){rd(function(){f(!0)})}}}function yd(b,c){a.isFunction(b)&&c===ye&&(c=b,b=null),(null===b||b===ye)&&(b="button");var d=a('<button class="turtleinput">'+fd(b)+"</button>");return c&&d.click(c),{result:d}}function zd(b,c,d){function e(){k||(k=setTimeout(function(){k=null},1e3))}function f(){if(!g())return!1;var b=i.val();k&&l==b||(e(),l=b,i.remove(),j.append(b).css({display:"table"}),(d>0||d>=0&&a.isNumeric(b)&&""+parseFloat(b)==b)&&(b=parseFloat(b)),j.prop("value",b),c&&setTimeout(function(){c.call(j,b)},0))}function g(){if(0>=d)return!0;var b=i.val(),c=b.replace(/[^0-9\.]/g,"");return b==c&&a.isNumeric(c)?!0:(i.val(c),!1)}function h(a){if(13==a.which){if(!g())return!1;f()}return d>0&&a.which>=32&&a.which<=127&&(a.which<"0".charCodeAt(0)||a.which>"9".charCodeAt(0))&&(a.which!=".".charCodeAt(0)||~i.val().indexOf("."))?!1:void 0}a.isFunction(b)&&!c&&(c=b,b=null),b=a.isNumeric(b)||b?b:"&rArr;";var i=a('<input class="turtleinput">').css({margin:0,padding:0}),j=a('<label style="display:table">'+b+"&nbsp;</label>").append(i),k=null,l=i.val();return i.on("keypress keydown",h),i.on("change",f),{result:j,setup:function(){if(e(),0>d){var a=j.parent().width(),b=a+j.offset().left-i.offset().left,c=Math.max(256,a/2),f=c>b?a:b,g=i.outerWidth(!0)-i.width();i.width(f-g)}rd(function(){i.focus()})}}}function Ad(b,c){a.isNumeric(c)&&(c={height:c});var d=a("<img>");return b&&d.attr("src",Db(b)),c&&d.css(c),{result:d}}function Bd(b,c,d,e){var f,g,h=null;if(a.isArray(b))for(e=d,d=c,h=b,b=h.length,c=0,f=0;b>f;f++)c=a.isArray(h[f])?Math.max(c,h[f].length):Math.max(c,1);var i=["<table>"];for(f=0;b>f;f++){
for(i.push("<tr>"),g=0;c>g;g++)h?a.isArray(h[f])&&g<h[f].length?i.push("<td>"+fd(h[f][g])+"</td>"):a.isArray(h[f])||0!=g?i.push("<td></td>"):i.push("<td>"+fd(h[f])+"</td>"):i.push("<td></td>");i.push("</tr>")}i.push("</table>");var j=a(i.join("")),k={borderCollapse:"collapse",width:"35px",height:"35px",border:"1px solid black",tableLayout:"fixed",textAlign:"center",margin:"0",padding:"0"};return j.css(a.extend({},k,{width:"auto",height:"auto",maxWidth:"auto",border:"none"},e)),j.find("td").css(a.extend({},k,d)),{result:j}}function Cd(a,b){return a+"("+Array.prototype.join.call(b,",")+")"}function Dd(a,b,c){var d=0,e=[],f={};for(var g in c){var h=c[g];for(d=b;d<a.length;++d)if(!~e.indexOf(d)){if("*"==h)break;if(h instanceof RegExp&&h.test(a[d]))break;if(h instanceof Function&&h(a[d]))break;if(h==typeof a[d])break}d<a.length&&(e.push(d),f[g]=a[d])}if(e.length+b<a.length){var i=[];for(d=b;d<a.length;++d)~e.indexOf(d)||i.push(a[d]);f.extra=i}return f}function Ed(b){if(0===arguments.length)b={};else if(2==arguments.length){var c={};c[arguments[0]]=arguments[1],b=c}else 1==arguments.length&&"function"==typeof arguments[0]&&(b={eval:arguments[0]});return"jQuery"in b&&(a=b.jQuery),"eval"in b&&(Pf[""].e=b.eval),"this"in b&&(Pf[""].t=b["this"]),"element"in b&&(Ff=b.element),"autoscroll"in b&&(Ef=b.autoscroll),"linestyle"in b&&(Cf=b.linestyle),"depth"in b&&(Df=b.depth),"panel"in b&&(Gf=b.panel),"height"in b&&(Nf=b.height),"title"in b&&(Kf=b.title),"console"in b&&(Lf=b.console),"history"in b&&(Mf=b.history),"coffee"in b&&(Qf=b.coffee),"abbreviate"in b&&(ag=b.abbreviate),"consolehook"in b&&(bg=b.consolehook),"consolelog"in b&&(Jf=b.consolelog),"noconflict"in b&&Ld(b.noconflict),Gf&&(Ff="#_testlog",Ef="#_testscroll",Gf===!0&&se()),Jf===!0&&re(),Fd()}function Fd(a,b,c){return arguments.length<=1?(arguments.length||(a=""),zf+".scope("+Sd(a)+","+Rf+",this)"):void(Pf[a]={e:b,t:c})}function Gd(a,b){1==arguments.length&&(b=a,a="");var c=Pf[""].e,d=Pf[""].t;return Pf.hasOwnProperty(a)&&(Pf[a].e&&(c=Pf[a].e),Pf[a].t&&(d=Pf[a].t)),xf.reportEvent("seeeval",[a,b]),c.call(d,b)}function Hd(a){var b=Qf||ze.CoffeeScript,c=b.compile(a,{bare:1});return c&&(c=c.replace(Tf,"")),c}function Id(){If.repr=ce,If.html=Nd,If.noconflict=Ld,If.init=Ed,If.scope=Fd,If.eval=Gd,If.barecs=Hd,If.here="eval("+zf+".init())",If.clear=ke,If.hide=ge,If.show=he,If.visible=ie,If.enter=je,If.js=Rf,If.cs="(function(){return eval("+zf+".barecs(arguments[0]));})",If.version=Af,ze[zf]=If}function Jd(a){return{name:a,has:ze.hasOwnProperty(a),value:ze[a]}}function Kd(a){a.has?ze[a.name]=a.value:delete ze[a.name]}function Ld(a){return a&&"string"==typeof a||(a="see"+(1+Math.random()+"").substr(2)),Bf&&Kd(Bf),zf=a,Bf=Jd(a),Id(),If}function Md(b){function c(a,b){function c(a,b){a.onload=a.onreadystatechange=b}var d=document.createElement("script"),e=document.getElementsByTagName("head")[0],f=1;c(d,function(){!f||d.readyState&&!{loaded:1,complete:1}[d.readyState]||(f=0,b(),c(d,null),e.removeChild(d))}),d.src=a,e.appendChild(d)}return!yf||a&&a.fn&&a.fn.jquery?void b():void c("//ajax.googleapis.com/ajax/libs/jquery/"+yf+"/jquery.min.js",function(){a=jQuery.noConflict(!0),b()})}function Nd(a){Yf.push('<samp class="_log">'),Yf.push(a),Yf.push("</samp>"),fe()}function Od(a){var b=Object.prototype.toString.call(a),c=b.substring(8,b.length-1);if("Object"==c){if("length"in a&&"slice"in a&&"number"==typeof a.length)return"Array";if("originalEvent"in a&&"target"in a&&"type"in a)return Od(a.originalEvent)}return c}function Pd(a){switch(a){case"String":case"Number":case"Boolean":case"Undefined":case"Date":case"RegExp":case"Null":return!0}return!1}function Qd(a){return a.nodeType&&a.nodeName&&"function"==typeof a.cloneNode}function Rd(a,b){return b&&b>3&&a.length>b?a.substring(0,Math.floor(b/2)-1)+"..."+a.substring(a.length-(Math.ceil(b/2)-2)):a}function Sd(a,b){function c(a){if(Wf.hasOwnProperty(a))return Wf[a];var b="0"+a.charCodeAt(0).toString(16);return"\\x"+b.substring(b.length-2)}return-1==a.indexOf('"')||-1!=a.indexOf("'")?Rd('"'+$d(a.replace(/[\0-\x1f\x7f-\x9f"\\]/g,c))+'"',b):Rd("'"+$d(a.replace(/[\0-\x1f\x7f-\x9f'\\]/g,c))+"'",b)}function Td(a,b){var c=Od(a);if("String"==c)return Sd(a,b);if("Undefined"==c||"Null"==c)return c.toLowerCase();if(Pd(c))return""+a;if("Array"==c&&0===a.length)return"[]";if("Object"==c&&Wd(a))return"{}";if(Qd(a)&&1==a.nodeType){if(a.hasAttribute("id"))return a.tagName.toLowerCase()+"#"+$d(a.getAttribute("id"));if(a.hasAttribute("class")){var d=a.getAttribute("class").split(" ")[0];if(d)return a.tagName.toLowerCase()+"."+$d(d)}return a.tagName.toLowerCase()}return c}function Ud(a){return 3!=a.nodeType||/[^\s]/.exec(a.textContent)}function Vd(a){return a.replace(/^\s*\n/,"")}function Wd(a,b,c){var d=Od(a);if(Pd(d))return!0;if(!b&&"Array"==d)return!c||a.length<=c;if(Qd(a))return 9==a.nodeType||11==a.nodeType?!1:1==a.nodeType?null===a.firstChild||null===a.firstChild.nextSibling&&3==a.firstChild.nodeType&&a.firstChild.textContent.length<=c:!0;if("Function"==d){var e=a.toString();return e.length-e.indexOf("{")<=c}if("Error"==d)return!!a.stack;var f=0;for(var g in a)if(a.hasOwnProperty(g)){if(f+=1,b&&!Pd(Od(a[g])))return!1;if(c&&f>c)return!1}return!0}function Xd(a,b){var c;if("outerHTML"in a){c=Wd(a,!0,b);var d=a.cloneNode(c).outerHTML,e=null;if(!c){var f=/^(.*)(<\/[^\s]*>$)/.exec(d);f&&(e=f[2],d=f[1])}return[$d(d),e&&$d(e)]}if(1==a.nodeType){for(var g=["<"+a.tagName],h=0;h<a.attributes.length;++h)g.push(Xd(a.attributes[h],b)[0]);return c=Wd(a,!0,b),c&&a.firstChild?[$d(g.join(" ")+">"+a.firstChild.textContent+"</"+a.tagName+">"),null]:[$d(g.join(" ")+(a.firstChild?">":"/>")),a.firstChild?$d("</"+a.tagName+">"):null]}return 2==a.nodeType?[$d(a.name+'="'+$d(Rd(a.value,b),'"')+'"'),null]:3==a.nodeType?[$d(Vd(a.textContent)),null]:4==a.nodeType?["<![CDATA["+$d(Rd(a.textContent,b))+"]]>",null]:8==a.nodeType?["<!--"+$d(Rd(a.textContent,b))+"-->",null]:10==a.nodeType?["<!DOCTYPE "+$d(a.nodeName)+">",null]:[a.nodeName,null]}function Yd(a,b){var c=Od(a);if(Pd(c))return Td(a,b);if(Qd(a)){var d=Xd(a,b);return d[0]+(d[1]?"..."+d[1]:"")}if("Function"==c){var e=a.toString();return e.length-e.indexOf("{")>b&&(e=e.replace(/\{(?:.|\n)*$/,"").trim()),e}if(("Error"==c||"ErrorEvent"==c)&&"message"in a)return a.message;var f=[];if("Array"==c&&a.length<b){for(var g=a.length>=5,h=g&&a[0],i=0;i<a.length;++i)g&&a[i]!==h&&(g=!1),f.push(Td(a[i],b));return g?"["+Td(h,b)+"]  "+a.length:"["+f.join(", ")+"]"}if(Wd(a,!1,b)){for(var j in a)a.hasOwnProperty(j)&&f.push(Zd(j)+": "+Td(a[j],b));return("Object"==c?"{":c+"{")+f.join(", ")+"}"}return"Array"==c?"Array("+a.length+")":c}function Zd(a){return/^\w+$/.exec(a)?a:Sd(a)}function $d(a,b){var c=/[<>&]/g;return b&&(c=new RegExp("[<>&"+b+"]","g")),a.replace(c,function(a){return"<"==a?"&lt;":">"==a?"&gt;":"&"==a?"&amp;":'"'==a?"&quot;":"&#"+a.charCodeAt(0)+";"})}function _d(a){a=a.replace(/^\s*\n/,"");var b=a.match(/^\s*\S/gm),c=b.length&&b[0].length-1,d=1;for(b.length>1&&"{"==b[0].trim()&&(c=b[1].length-1,d=2);d<b.length;++d)if(c=Math.min(b[d].length-1,c),0>=c)return a;var e=new RegExp("^\\s{"+c+"}","mg");return a.replace(e,"")}function ae(a,b,c,d){if(d.push('<label class="_log"><input type="checkbox"><span>'),a&&d.push(a),Qd(b)){var e=Xd(b,10);d.push(e[0]),d.push("</span><ul>");for(var f=b.firstChild;f;f=f.nextSibling)Ud(f)&&(3==f.nodeType?(d.push("<li><samp>"),d.push(_d(f.textContent)),d.push("</samp></li>")):Wd(f,!0,20)||1>=c?d.push("<li>"+Yd(f,20)+"</li>"):ae("",f,c-1,d));d.push("</ul>"),e[1]&&(d.push("<span>"),d.push(e[1]),d.push("</span>")),d.push("</label>")}else{d.push(Yd(b,10)),d.push("</span><ul>");var g=Od(b);if("Function"==g){var h=b.toString(),i=/\{(?:.|\n)*$/.exec(h);i&&(h=i[0]),d.push("<li><samp>"),d.push($d(_d(h))),d.push("</samp></li>")}else if("Error"==g)d.push("<li><samp>"),d.push($d(b.stack)),d.push("</samp></li>");else if("Array"==g){for(var j=0;j<Math.min(100,b.length);++j){try{n=b[j]}catch(k){n=k}Wd(n,!0,20)||1>=c||"global"==Od(n)?d.push("<li>"+j+": "+Yd(n,100)+"</li>"):ae(j+": ",n,c-1,d)}b.length>100&&d.push("<li>length="+b.length+" ...</li>")}else{var l=0;for(var m in b)if(b.hasOwnProperty(m)){if(l+=1,l>100)continue;var n;try{n=b[m]}catch(k){n=k}Wd(n,!0,20)||1>=c||"global"==Od(n)?(d.push("<li>"),d.push(Zd(m)),d.push(": "),d.push(Yd(n,100)),d.push("</li>")):ae(Zd(m)+": ",n,c-1,d)}l>100&&d.push("<li>"+l+" properties total...</li>")}d.push("</ul></label>")}}function be(){if(!Vf&&!ze.document.getElementById("_logcss")){var a=ze.document.createElement("style");a.id="_logcss",a.innerHTML=(Cf?"samp._log{"+Cf+"}":"")+Uf,ze.document.head.appendChild(a),Vf=!0}}function ce(a,b,c){b=b||3;var d=c||[],e=Od(a);return"Error"==e||"ErrorEvent"==e?(d.push('<span style="color:red;">'),ae("",a,b,d),d.push("</span>")):Pd(e)?d.push(Td(a)):Wd(a,!0,100)||0>=b?d.push(Yd(a,100)):ae("",a,b,d),c?void 0:d.join("")}function de(b,c){switch(typeof b){case"string":return"body"==b?document.body:document.querySelector?document.querySelector(b):a?a(b)[0]:null;case"undefined":return c;case"boolean":return b?c:null;default:return b}return null}function ee(){var a=!1,b=de(Ef,null);return b&&(a=b.scrollHeight-b.scrollTop-10<=b.clientHeight),a?function(){b.scrollTop=b.scrollHeight-b.clientHeight}:function(){}}function fe(){var a=de(Ff,null);if(a&&a.appendChild&&Yf.length){be();var b=ze.document.createElement("samp");b.innerHTML=Yf.join(""),Yf.length=0;for(var c=ee();child=b.firstChild;)a.appendChild(child);c()}!Xf&&Yf.length?("auto"==Gf&&se(),Xf=setTimeout(function(){timer=null,fe()},100)):Xf&&!Yf.length&&(clearTimeout(Xf),Xf=null)}function ge(){a("#_testpanel").hide()}function he(){a("#_testpanel").show()}function ie(){return a("#_testpanel").is(":visible")}function je(b){a("#_testinput").val(b)}function ke(){Zf&&a("#_testlog").find("._log").not("#_testpaneltitle").remove()}function le(a){return'<samp class="_logcaret" style="color:'+a+';"></samp>'}function me(){return ze.getSelection?ze.getSelection().toString():document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:void 0}function ne(a){return'<samp class="_log" id="_testpaneltitle" style="font-weight:bold;">'+a+"</samp>"}function oe(){if(Mf){var b,c={height:Nf,history:[]};try{b=ze.JSON.parse(ze.localStorage[Mf])}catch(d){b=cg||{}}return b&&b.slice&&b.length?(c.history=b,c):(a.extend(c,b),c)}}function pe(a){if(Mf){var b=oe(),c=!1;if("history"in a&&a.history.length&&(!b.history.length||b.history[b.history.length-1]!==a.history[a.history.length-1])&&(b.history.push(a.history[a.history.length-1]),c=!0),"height"in a&&a.height!==b.height&&(b.height=a.height,c=!0),c)try{ze.localStorage[Mf]=ze.JSON.stringify(b)}catch(d){cg=b}}}function qe(){return ze.innerHeight||a(ze).height()}function re(){try{if(Jf&&ze.console&&!ze.console._log&&"function"==typeof ze.console.log){var a=ze.console._log=ze.console.log;global_.console.log=function(){a.apply(this,arguments),If.apply(this,arguments)}}}catch(b){}}function se(){$f||($f=!0,Md(te))}function te(){if(Zf)Kf&&(a("#_testpaneltitle").length?a("#_testpaneltitle").html(Kf):a("#_testlog").prepend(ne(Kf))),a("#_testpanel").show();else if(!ze.document.getElementById("_testlog")&&ze.document.body){re(),be();var b=oe(),c=Kf?ne(Kf):"";b.height>qe()-50&&(b.height=Math.min(qe(),Math.max(10,qe()-50))),a("body").prepend('<samp id="_testpanel" class="turtlefield" style="overflow:hidden;z-index:99;position:fixed;bottom:0;left:0;width:100%;height:'+b.height+'px;background:rgba(240,240,240,0.8);font:10pt monospace;-webkit-transform:translateZ(0);"><samp id="_testdrag" style="cursor:row-resize;height:6px;width:100%;display:block;background:lightgray"></samp><samp id="_testscroll" style="overflow-y:scroll;overflow-x:hidden;display:block;width:100%;height:'+(b.height-6)+'px;"><samp id="_testlog" style="display:block">'+c+'</samp><samp class="_log" style="position:relative;display:block;">'+le("blue")+'<input id="_testinput" class="_log" style="width:100%;margin:0;border:0;font:inherit;background:rgba(255,255,255,0.8);"></samp></samp>'),Zf=!0,fe();var d=0,e={};a("#_testinput").on("keydown",function(c){if(13==c.which){var f=a(this).val();if(a(this).val(""),!f.trim().length||b.history.length&&b.history[b.history.length-1]===f||(b.history.push(f),pe({history:[f]})),e={},d=0,Nd('<samp class="_log" style="margin-left:-1em;">'+le("lightgray")+$d(f)+"</samp>"),a(this).select(),f.trim().length&&":"==f.trim()[0]){var g=f.trim().substring(1).trim();if(!g||Pf.hasOwnProperty(g)){Of=g;var h=g?"scope "+g:"default scope";Nd('<span style="color:blue">switched to '+h+"</span>")}else Nd('<span style="color:red">no scope '+g+"</span>");return}a.turtle.interrupt("reset");var i=!1;try{var j;try{j=Gd(Of,f)}finally{if(bg&&bg(f,j))i=!0;else{for(var k=ag.length-1;k>=0&&j!==ag[k];--k);0>k&&Nd(ce(j))}}}catch(c){i||If(c)}}else if(38==c.which||40==c.which){e[d]=a(this).val(),d+=38==c.which?1:-1,d=Math.max(0,Math.min(b.history.length,d));var l=e[d]||b.history[b.history.length-d];"undefined"==typeof l&&(l=""),a(this).val(l),this.selectionStart=this.selectionEnd=l.length,c.preventDefault()}}),a("#_testdrag").on("mousedown",function(c){var d,e=this,f=a("#_testpanel").height()+c.pageY,g=a("#_testdrag").height(),h=c.which;return e.setCapture&&e.setCapture(!0),d=function(c){if("blur"!=c.type&&c.which==h){var e=qe(),i=Math.max(g,Math.min(e,f-c.pageY)),j=ee();a("#_testpanel").height(i),a("#_testscroll").height(i-g),j()}("mouseup"==c.type||"blur"==c.type||"mousemove"==c.type&&c.which!=h)&&(a(ze).off("mousemove mouseup blur",d),document.releaseCapture&&document.releaseCapture(),a("#_testpanel").height()!=b.height&&(b.height=a("#_testpanel").height(),pe({height:b.height})))},a(ze).on("mousemove mouseup blur",d),!1}),a("#_testpanel").on("mouseup",function(b){if(!me()){var c=a("#_testscroll").scrollTop();a("#_testinput").focus(),a("#_testscroll").scrollTop(c)}})}_f&&Zf?clearTimeout(_f):Zf||_f||(_f=setTimeout(te,100))}function ue(a,b){var c=document.createElement("canvas");b||(b=0),c.width=a.width,c.height=a.height;var d=c.getContext("2d");return d.drawImage(a,0,0),ve(c,b)}function ve(a,b){for(var c,d,e=a.getContext("2d"),f=e.getImageData(0,0,a.width,a.height).data,g=[],h=256*b,i=1/0,j=-1,k=0;k<a.height;++k){c=1/0,d=-1;for(var l=0;l<a.width;++l)f[4*k*a.width+4*l+3]>h&&(0>d&&(c=l),d=l);(d>=0||j>=0)&&(g.push({pageX:Math.min(c,i),pageY:k}),g.push({pageX:Math.max(d,j)+1,pageY:k})),i=c,j=d}return j>=0&&(g.push({pageX:i,pageY:a.height}),g.push({pageX:j+1,pageY:a.height})),ka(g)}function we(a,b){var c=a.getContext("2d"),d=a.width,e=a.height,f=0;if(c.save(),c.beginPath(),c.moveTo(0,0),c.lineTo(d,0),c.lineTo(d,e),c.lineTo(0,e),c.closePath(),b.length)for(c.moveTo(b[0].pageX,b[0].pageY);f<b.length;f+=1)c.lineTo(b[f].pageX,b[f].pageY);c.closePath(),c.clip(),c.clearRect(0,0,d,e),c.restore()}function xe(a,b,c,d,e){for(var f=0;f<a.length;f++)a[f].pageX=a[f].pageX*b+d,a[f].pageY=a[f].pageY*c+e}var ye=void 0,ze=this,Ae={}.hasOwnProperty,Be=jQuery(function(){}),Ce=!1,De=0,Ee=0,Fe=[];if(!a.cssHooks)throw"jQuery 1.4.3+ is needed for jQuery-turtle to work";var Ge=d("transform"),He=d("transformOrigin");if(Ge&&e()){var Ie={attached:!1,surface:null,field:null,ctx:null,canvas:null,timer:null,fieldMouse:!1,fieldHook:!1,subpixel:1},Je=document.createElement("a"),Ke={},Le=function(b){function d(b,c){this.constructor=jQuery,this.constructor.prototype=Object.getPrototypeOf(this),(!b||"string"==typeof b||a.isPlainObject(b)||"number"==typeof b)&&(b=gd(b,c,"256x256")),jQuery.fn.init.call(this,b,c,Be)}return c(d,b),d.prototype.pushStack=function(){var a,b,c;for(b=jQuery.fn.pushStack.apply(this,arguments),a=b.length,c=a===this.length;c&&a--;)c=c&&this[a]===b[a];return c?this:b},d}(jQuery.fn.init),Me=function(b){function d(b){b&&b.jquery&&a.isFunction(b.canvas)&&(b=b.canvas()),!b||"CANVAS"==b.tagName&&"function"==typeof b.getContext||(b=a(b).filter("canvas").get(0)),b&&"CANVAS"==b.tagName&&"function"==typeof b.getContext||(b=null);var c=b?b.parentElement:null,e={width:0,height:0,color:transparent};d.__super__.constructor.call(this,e,c),this.each(function(){var a=Ma(this);a.speed=1/0,a.drawOnCanvas=b,this.style.display="none",b&&(this.style[Ge]=sa(qa(b,!0)))})}return c(d,b),d}(Le),Ne=function(a){function b(a,c){b.__super__.constructor.call(this,gd(a,c,"turtle"))}return c(b,a),b}(Le),Oe=function(b){function d(b,c){var e="",f=!1,g=!1,h=!1;if(a.isPlainObject(b)){for(key in b)e+=" "+key+'="'+fd(b[key])+'"';f="src"in b,g="autoplay"in b,h="width"in b||"height"in b,!h||"height"in b||(e+=" height="+Math.round(3*b.width/4)),!h||"width"in b||(e+=" width="+Math.round(4*b.height/3))}g||(e+=" autoplay"),h||(e+=" width=320 height=240"),d.__super__.constructor.call(this,"<video"+e+">"),f||this.capture()}return c(d,b),d.prototype.capture=function(){return this.queue(function(b){var c=this,d=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return d?void d.call(navigator,{video:!0},function(d){if(d){var e=Ma(c),f=(""+Math.random()).substr(2);e.stream&&e.stream.stop(),e.stream=d,a(c).on("play.capture"+f,function(){a(c).off("play.capture"+f),b()}),c.src=ze.URL.createObjectURL(d)}},function(){b()}):void b()})},d.prototype.cut=function(){return this.plan(function(){var a=this.data("turtleData");a.stream&&(a.stream.stop(),a.stream=null),this.attr("src","")})},d}(Le),Pe=function(a){function b(a){var c,i,j,k,l,m,n,o,p,q,r,s=null,t=this;a=f(a,"keys"),q=Xe.pitchToMidi(a.lowest),r=Xe.pitchToMidi(a.highest);var u=this._geom={};if(u.lineWidth="lineWidth"in a?a.lineWidth:1.5,u.color="color"in a?a.color:"white",u.blackColor="blackColor"in a?a.blackColor:"black",u.lineColor="lineColor"in a?a.lineColor:"black",j=Math.ceil(u.lineWidth),i=422,c=4.2,null!=q&&null!=r?s=e(r)-e(q)+1:"keys"in a&&(s=Math.ceil(a.keys/12*7)),s&&(c=s/5,i=Math.sqrt(42e3*c)+j),m="width"in a?a.width:"height"in a?Math.round((a.height-j)*c+j):i,l="height"in a?a.height:Math.round((m-j)/c+j),s||(s=Math.max(1,Math.round((m-j)/(l-j)*5))),n=Math.min(e(108),Math.ceil(42+(s-1)/2)),u.highest=null!=r?r:null!=q&&"keys"in a?q+a.keys-1:g(null!=q?e(q)+s-1:n),u.lowest=null!=q?q:"keys"in a?u.highest-a.keys+1:Math.min(u.highest,g(e(u.highest)-s+1)),k=e(u.lowest),n=e(u.highest),h(u.highest)&&(n+=1),s=n-k+1,u.kw=(m-j)/s,u.kh=("height"in a?a.height-j:5*u.kw)+(j-u.lineWidth),u.bkw=4*u.kw/7,u.bkh=3*u.kh/5,u.halfex=j/2,u.leftpx=k*u.kw,u.rightpx=(n+1)*u.kw,u.ckw=(3*u.kw-2*u.bkw)/3,u.fkw=(4*u.kw-3*u.bkw)/4,b.__super__.constructor.call(this,{width:Math.ceil(u.rightpx-u.leftpx+j),height:Math.ceil(u.kh+j)}),"timbre"in a)p=a.timbre;else for(o in Xe.defaultTimbre)o in a&&(p||(p={}),p[o]=a[o]);return p||(p="piano"),this.css({turtleTimbre:p}),this.on("noteon",function(a){t.drawkey(a.midi,d(a.midi))}),this.on("noteoff",function(a){t.drawkey(a.midi)}),this.draw(),this}function d(a){return k[(a%12+12)%12]}function e(a){return floor((a+7)/12*7)}function g(a){return ceil(a/7*12)-7}function h(a){return i(a)>=8}function i(a){return[1,8,2,9,3,4,10,5,11,6,12,7][(a%12+12)%12]}function j(a,b,c){var d,f,g,j,k,l,m;switch(l=b.halfex+b.kw*e(c)-b.leftpx,m=b.halfex,d=i(c),g=c===b.lowest,k=c===b.highest,f=0,j=0,d){case 1:j=b.kw-b.ckw;break;case 2:j=f=(b.kw-b.ckw)/2;break;case 3:f=b.kw-b.ckw;break;case 4:j=b.kw-b.fkw;break;case 5:f=b.fkw+b.bkw-b.kw,j=2*b.kw-2*b.fkw-b.bkw;break;case 6:f=2*b.kw-2*b.fkw-b.bkw,j=b.fkw+b.bkw-b.kw;break;case 7:f=b.kw-b.fkw;break;case 8:l+=b.ckw;break;case 9:l+=2*b.ckw+b.bkw-b.kw;break;case 10:l+=b.fkw;break;case 11:l+=2*b.fkw+b.bkw-b.kw;break;case 12:l+=3*b.fkw+2*b.bkw-2*b.kw}return g&&(f=0),k&&(j=0),h(c)?(a.moveTo(l,m+b.bkh),a.lineTo(l+b.bkw,m+b.bkh),a.lineTo(l+b.bkw,m),a.lineTo(l,m),a.closePath()):(a.moveTo(l,m+b.kh),a.lineTo(l+b.kw,m+b.kh),a.lineTo(l+b.kw,m+b.bkh),a.lineTo(l+b.kw-j,m+b.bkh),a.lineTo(l+b.kw-j,m),a.lineTo(l+f,m),a.lineTo(l+f,m+b.bkh),a.lineTo(l,m+b.bkh),a.closePath())}c(b,a),b.prototype.drawkey=function(a,b){var c,d=this._geom;if(d.lowest<=a&&a<=d.highest)return null==b&&(b=h(a)?d.blackColor:d.color),c=this.canvas().getContext("2d"),c.save(),c.beginPath(),j(c,d,a),c.fillStyle=b,c.strokeStyle=d.lineColor,c.lineWidth=d.lineWidth,c.fill(),c.stroke(),c.restore()},b.prototype.draw=function(){for(var a=this._geom.lowest;a<=this._geom.highest;++a)this.drawkey(a)};var k=["#db4437","#ff5722","#f4b400","#ffeb3b","#cddc39","#0f9d58","#00bcd4","#03a9f4","#4285f4","#673ab7","#9c27b0","#e91e63"];return b}(Le),Qe=!1,Re=function(){for(var a="undefined"!=typeof ze?ze.navigator.userAgent:"",b=/OS X/.test(a),c=/Opera/.test(a),d=!/like Gecko/.test(a)&&!c,e={0:"null",1:"mouse1",2:"mouse2",3:"break",4:"mouse3",5:"mouse4",6:"mouse5",8:"backspace",9:"tab",12:"clear",13:"enter",16:"shift",17:"control",18:"alt",19:"pause",20:"capslock",21:"hangulmode",23:"junjamode",24:"finalmode",25:"kanjimode",27:"escape",28:"convert",29:"nonconvert",30:"accept",31:"modechange",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",41:"select",42:"print",43:"execute",44:"snapshot",45:"insert",46:"delete",47:"help",91:"meta",92:"meta",93:b?"meta":"menu",95:"sleep",106:"numpad*",107:"numpad+",108:"numpadenter",109:"numpad-",110:"numpad.",111:"numpad/",144:"numlock",145:"scrolllock",160:"shiftleft",161:"shiftright",162:"controlleft",163:"controlright",164:"altleft",165:"altright",166:"browserback",167:"browserforward",168:"browserrefresh",169:"browserstop",170:"browsersearch",171:"browserfavorites",172:"browserhome",173:b&&d?"-":"volumemute",174:"volumedown",175:"volumeup",176:"mediatracknext",177:"mediatrackprev",178:"mediastop",179:"mediaplaypause",180:"launchmail",181:"launchmediaplayer",182:"launchapp1",183:"launchapp2",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"meta",224:"meta",226:"altgraph",229:"process",231:c?"`":"unicode",246:"attention",247:"crsel",248:"exsel",249:"eraseeof",250:"play",251:"zoom",252:"noname",253:"pa1",254:"clear"},f=48;91>f;++f)e[f]=String.fromCharCode(f).toLowerCase();for(f=96;106>f;++f)e[f]="numpad"+(f-96);for(f=112;136>f;++f)e[f]="f"+(f-111);return e}(),Se=function(){function a(a,c){return function(d){var e,f=d.which;a?e="mouse"+f:(!f&&d.whichSynth&&(f=d.whichSynth),e=Re[f],f>=160&&165>=f&&b(e.replace(/(?:left|right)$/,""),c)),b(e,c)}}function b(a,b){null!=a&&(b?h[a]=!0:delete h[a])}function c(){for(var a in h)delete h[a]}function d(a){c();for(var b in g)a?ze.addEventListener(b,g[b],!0):ze.removeEventListener(b,g[b])}function e(){var a,b=[];for(a in h)h[a]&&b.push(a);return b}function f(a){return Lb(),a?(a=a.replace(/\s/g,"").toLowerCase(),h[a]?!0:!1):e()}var g={mousedown:a(1,1),mouseup:a(1,0),keydown:a(0,1),keyup:a(0,0),blur:c},h={};return f.enable=d,f.list=e,f}(),Te=null,Ue={C:0,D:2,E:4,F:5,G:7,A:9,B:11,c:12,d:14,e:16,f:17,g:19,a:21,b:23},Ve={"^":1,"":0,"=":0,_:-1},We=["C","^C","D","_E","E","F","^F","G","_A","A","_B","B","c","^c","d","_e","e","f","^f","g","_a","a","_b","b"],Xe=function(){function a(a){this._atop=$b(),this._timbre=b(a,this._atop),this._queue=[],this._minQueueTime=1/0,this._maxScheduledTime=0,this._unsortedQueue=!1,this._startSet=[],this._finishSet={},this._cleanupSet=[],this._callbackSet=[],this._handlers={},this._now=null,Zb()&&this.silence()}function b(a,b){a||(a={}),"string"==typeof a&&(a={wave:a});var c,d={},f=b&&b.wavetable&&b.wavetable[a.wave];for(c in e)a.hasOwnProperty(c)?d[c]=a[c]:f&&f.defs&&f.defs.hasOwnProperty(c)?d[c]=f.defs[c]:d[c]=e[c];return d}function c(){if(null==c)for(var a=$b().ac,b=2*a.sampleRate,c=a.createBuffer(1,b,a.sampleRate),d=c.getChannelData(0),e=0;b>e;e++)d[e]=2*Math.random()-1;return c}function d(a,b,d){if("noise"==b){var e=a.ac.createBufferSource();return e.buffer=c(),e.loop=!0,e}var f,g,h,i,j=a.wavetable,k=a.ac.createOscillator();try{if(j.hasOwnProperty(b)){if(g=j[b].wave,j[b].freq){h=0;for(f in j[b].freq)i=Number(f),d>i&&i>h&&(h=i,g=j[b].freq[h])}!k.setPeriodicWave&&k.setWaveTable?k.setWaveTable(g):k.setPeriodicWave(g)}else k.type=b}catch(l){window.console&&window.console.log(l),k.type="square"}return k.frequency.value=d,k}a.timeOffset=.0625,a.dequeueTime=.5,a.bufferSecs=2,a.toneLength=1,a.cleanupDelay=.1,a.prototype.setTimbre=function(a){this._timbre=b(a,this._atop)},a.prototype.getTimbre=function(a){return b(this._timbre,this._atop)},a.prototype.setVolume=function(a){this._out&&(isNaN(a)||(this._out.gain.value=a))},a.prototype.getVolume=function(a){return this._out?this._out.gain.value:0},a.prototype.silence=function(){var a,b,c,d=1;this._queue.length=0,this._minQueueTime=1/0,this._maxScheduledTime=0,this._startSet.length=0,b=this._finishSet,this._finishSet={},c=this._callbackSet,this._callbackSet=[],this._out&&(this._out.disconnect(),d=this._out.gain.value),this._atop=$b(),this._out=this._atop.ac.createGain(),this._out.gain.value=d,this._out.connect(this._atop.out);for(a in b)this._trigger("noteoff",b[a]);for(a=0;a<c.length;++a)c[a].callback()},a.prototype.now=function(){return null!=this._now?this._now:(this._startPollTimer(!0),this._now)},a.prototype.on=function(a,b){this._handlers.hasOwnProperty(a)||(this._handlers[a]=[]),this._handlers[a].push(b)},a.prototype.off=function(a,b){if(this._handlers.hasOwnProperty(a))if(b){var c,d=this._handlers[a];for(c=0;c<d.length;++c)d[c]===b&&(d.splice(c,1),c-=1)}else this._handlers[a]=[]},a.prototype._trigger=function(a,b){var c,d=this._handlers[a];if(d){if(1==d.length)return void d[0](b);for(d=d.slice(),c=0;c<d.length;++c)d[c](b)}},a.prototype._makeSound=function(b){var c,e,f,g,h=b.timbre||this._timbre,i=b.time+a.timeOffset,j=i+b.duration,k=Math.min(j,i+h.attack),l=h.decay*Math.pow(440/b.frequency,h.decayfollow),m=k,n=j+h.release,o=h.detune&&1!=h.detune,p=h.gain*b.velocity*(o?.5:1),q=this._atop.ac;if(b.duration>0&&b.velocity>0){for(c=q.createGain(),c.gain.setValueAtTime(0,i),c.gain.linearRampToValueAtTime(p,k);k+1/32>m&&j>m+1/256;)m+=1/256,c.gain.linearRampToValueAtTime(p*(h.sustain+(1-h.sustain)*Math.exp((k-m)/l)),m);c.gain.setTargetAtTime(p*h.sustain,m,l),c.gain.setValueAtTime(p*(h.sustain+(1-h.sustain)*Math.exp((k-j)/l)),j),c.gain.linearRampToValueAtTime(0,n),c.connect(this._out),!h.cutoff&&!h.cutfollow||h.cutoff==1/0?e=c:(e=q.createBiquadFilter(),e.frequency.value=h.cutoff+b.frequency*h.cutfollow,e.Q.value=h.resonance,e.connect(c)),f=d(this._atop,h.wave,b.frequency),f.connect(e),f.start(i),f.stop(n),o&&(g=d(this._atop,h.wave,b.frequency*h.detune),g.connect(e),g.start(i),g.stop(n)),b.gainNode=c,b.oscillators=[f],o&&b.oscillators.push(g),b.cleanuptime=n}else b.duration=0;this._startSet.push(b)},a.prototype._truncateSound=function(b,c){if(c<b.time+b.duration&&(b.duration=Math.max(0,c-b.time),b.gainNode)){var d,e=b.timbre||this._timbre,f=b.time+a.timeOffset,g=c+a.timeOffset,h=Math.min(g,f+e.attack),i=e.decay*Math.pow(440/b.frequency,e.decayfollow),j=g+e.release,k=j+a.cleanupDelay,l=e.detune&&1!=e.detune,m=e.gain*b.velocity*(l?.5:1),n=b.gainNode;if(n.gain.cancelScheduledValues(g),f>=g?n.gain.setValueAtTime(0,g):h>=g?n.gain.linearRampToValueAtTime(m*(g-f)/(h-f)):n.gain.setValueAtTime(m*(e.sustain+(1-e.sustain)*Math.exp((h-g)/i)),g),n.gain.linearRampToValueAtTime(0,j),b.oscillators)for(d=0;d<b.oscillators.length;++d)b.oscillators[d].stop(j);b.cleanuptime=k}},a.prototype._doPoll=function(){if(this._pollTimer=null,this._now=null,Ce)return void this.silence();var b,c,d,e,f,g,h,i,j=this._atop.ac.currentTime+5e-4,k=[];if(this._minQueueTime-j<=a.bufferSecs){for(this._unsortedQueue&&(this._queue.sort(function(a,b){return a.time!=b.time?a.time-b.time:a.duration!=b.duration?a.duration-b.duration:a.frequency-b.frequency}),this._unsortedQueue=!1),b=0;b<this._queue.length&&!(this._queue[b].time-j>a.bufferSecs);++b);if(b>0){for(c=this._queue.splice(0,b),b=0;b<c.length;++b)this._makeSound(c[b]);this._minQueueTime=this._queue.length>0?this._queue[0].time:1/0}}for(b=0;b<this._cleanupSet.length;++b)f=this._cleanupSet[b],f.cleanuptime<j&&(f.gainNode&&(f.gainNode.disconnect(),f.gainNode=null),this._cleanupSet.splice(b,1),b-=1);for(e in this._finishSet)f=this._finishSet[e],d=f.time+f.duration,j>=d&&(k.push({order:[d,0],f:this._trigger,t:this,a:["noteoff",f]}),f.cleanuptime!=1/0&&this._cleanupSet.push(f),delete this._finishSet[e]);for(b=0;b<this._callbackSet.length;++b)i=this._callbackSet[b],d=i.time,j>=d&&(k.push({order:[d,1],f:i.callback,t:null,a:[]}),this._callbackSet.splice(b,1),b-=1);for(b=0;b<this._startSet.length;++b)this._startSet[b].time<=j&&(h=f=this._startSet[b],e=f.frequency,g=null,this._finishSet.hasOwnProperty(e)&&(g=this._finishSet[e],g.time<f.time||g.time==f.time&&g.duration<f.duration?(this._truncateSound(g,f.time),k.push({order:[f.time,0],f:this._trigger,t:this,a:["noteoff",g]}),delete this._finishSet[e]):(this._truncateSound(f,g.time),g=f)),this._startSet.splice(b,1),b-=1,f.duration>0&&f.velocity>0&&g!==f&&(this._finishSet[e]=f,k.push({order:[f.time,2],f:this._trigger,t:this,a:["noteon",f]})));for(this._startPollTimer(),k.sort(function(a,b){return a.order[0]!=b.order[0]?a.order[0]-b.order[0]:a.order[1]-b.order[1]}),b=0;b<k.length;++b)i=k[b],i.f.apply(i.t,i.a)},a.prototype._startPollTimer=function(b){if(!this._pollTimer||null==this._now){var c,d,e=this,f=function(){e._doPoll()},g=1/0;if(this._pollTimer&&(clearTimeout(this._pollTimer),this._pollTimer=null),b)return this._now=ac(),void(this._pollTimer=setTimeout(f,0));for(c=0;c<this._startSet.length;++c)g=Math.min(g,this._startSet[c].time);for(c in this._finishSet)g=Math.min(g,this._finishSet[c].time+this._finishSet[c].duration);for(c=0;c<this._callbackSet.length;++c)g=Math.min(g,this._callbackSet[c].time);this._cleanupSet.length>0&&(g=Math.min(g,this._cleanupSet[0].cleanuptime+1)),g=Math.min(g,this._minQueueTime-a.dequeueTime),d=Math.max(.001,g-this._atop.ac.currentTime),isNaN(d)||d==1/0||(this._pollTimer=setTimeout(f,Math.round(1e3*d)))}},a.prototype.tone=function(b,c,d,f,g,h){if(this._atop){"object"==typeof b&&(null==d&&(d=b.velocity),null==c&&(c=b.duration),null==f&&(f=b.delay),null==g&&(g=b.timbre),null==h&&(h=b.origin),b=b.pitch);var i,j;if(b||(b="C"),isNaN(b)?(i=dc(b),j=bc(i)):(j=Number(b),0>j?(i=-j,j=bc(i)):i=cc(j)),g||(g=this._timbre),g!==this._timbre){var k,l=g;g={};for(k in e)k in l?g[k]=l[k]:g[k]=defaulTimbre[k]}var m=(this._atop.ac,this.now()),n=m+(f||0),o={time:n,on:!1,frequency:j,midi:i,velocity:null==d?1:d,duration:null==c?a.toneLength:c,timbre:g,instrument:this,gainNode:null,oscillators:null,cleanuptime:1/0,origin:h};n<m+a.bufferSecs?this._makeSound(o):(!this._unsortedQueue&&this._queue.length&&n<this._queue[this._queue.length-1].time&&(this._unsortedQueue=!0),this._queue.push(o),this._minQueueTime=Math.min(this._minQueueTime,o.time))}},a.prototype.schedule=function(a,b){this._callbackSet.push({time:this.now()+a,callback:b})},a.prototype.play=function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=Array.prototype.slice.call(arguments),t=null,u={},v=0,w=[];if(s.length&&"function"==typeof s[s.length-1]&&(t=s.pop()),!this._atop)return void(t&&t());if(e=0,"object"==typeof s[0]){for(g in s[0])s[0].hasOwnProperty(g)&&(u[g]=s[0][g]);e=1,u.song&&s.push(u.song)}for(;e<s.length;++e)for(c=s[e].split(/\n(?=X:)/),g=0;g<c.length;++g)d=gc(c[g]),d&&(!u.tempo&&d.tempo&&(u.tempo=d.tempo,d.unitbeat&&(u.tempo*=d.unitbeat/(d.unitnote||1))),d.voice&&w.push(d));for(u.tempo||(u.tempo=120),null==u.volume&&(u.volume=1),p=60/u.tempo,g=0;g<w.length;++g){d=w[g];for(l in d.voice)if(f=b(u.timbre||d.voice[l].timbre||d.timbre||this._timbre,this._atop),j=d.voice[l].stems){for(h=0,k=0;k<j.length;++k){for(n=j[k],i=1/Math.sqrt(n.notes.length),m=0;m<n.notes.length;++m)o=n.notes[m],o.holdover||(q=(o.time||n.time)*p,n.staccato?q=Math.min(Math.min(q,p/16),f.attack+f.decay):!o.slurred&&q>=1/8&&(q-=1/32),r=(o.velocity||1)*i*u.volume,this.tone(o.pitch,q,r,h,f,o));h+=n.time*p}v=Math.max(h,v)}}this._maxScheduledTime=Math.max(this._maxScheduledTime,this.now()+v),t&&this.schedule(v,t)};var e=a.defaultTimbre={wave:"square",gain:.1,attack:.002,decay:.4,decayfollow:0,sustain:0,release:.1,cutoff:0,cutfollow:0,resonance:0,detune:0};return a.pitchToMidi=function(a){return"string"==typeof a?dc(a):a},a.midiToPitch=function(a){return"number"==typeof a?ec(a):a;
},a}(),Ye=/^([A-Za-z]):\s*(.*)$/,Ze=/(?:\[[A-Za-z]:[^\]]*\])|\s+|%[^\n]*|![^\s!:|\[\]]*!|\+[^+|!]*\+|[_<>@^]?"[^"]*"|\[|\]|>+|<+|(?:(?:\^+|_+|=|)[A-Ga-g](?:,+|'+|))|\(\d+(?::\d+){0,2}|\d*\/\d+|\d+\/?|\/+|[xzXZ]|\[?\|\]?|:?\|:?|::|./g;a.extend(!0,a,{cssHooks:{turtlePenStyle:Pa(),turtlePenDown:Qa(),turtleSpeed:lb(),turtleEasing:mb(),turtleForward:pb(),turtleTurningRadius:Oa(),turtlePosition:xb("turtlePosition","tx","ty",!0),turtlePositionX:qb("tx",parseFloat,"px",!0),turtlePositionY:qb("ty",parseFloat,"px",!0),turtleRotation:qb("rot",tb,"deg",!0),turtleScale:xb("turtleScale","sx","sy",!1),turtleScaleX:qb("sx",h,"",!1),turtleScaleY:qb("sy",h,"",!1),turtleTwist:qb("twi",va,"deg",!1),turtleHull:na(),turtleTimbre:Vb(),turtleVolume:Wb()},cssNumber:{turtleRotation:!0,turtleSpeed:!0,turtleScale:!0,turtleScaleX:!0,turtleScaleY:!0,turtleTwist:!0},support:{turtle:!0}}),a.extend(!0,a.fx,{step:{turtlePosition:wb("turtlePosition",!0),turtleRotation:ub("turtleRotation"),turtleScale:wb("turtleScale",!1),turtleTwist:ub("turtleTwist")},speeds:{turtle:0}}),mc.helptext=[];var $e={rt:sc("rt",1,["<u>rt(degrees)</u> Right turn. Pivots clockwise by some degrees: <mark>rt 90</mark>","<u>rt(degrees, radius)</u> Right arc. Pivots with a turning radius: <mark>rt 90, 50</mark>"],yc),lt:sc("lt",1,["<u>lt(degrees)</u> Left turn. Pivots counterclockwise by some degrees: <mark>lt 90</mark>","<u>lt(degrees, radius)</u> Left arc. Pivots with a turning radius: <mark>lt 90, 50</mark>"],yc),fd:sc("fd",1,["<u>fd(pixels)</u> Forward. Moves ahead by some pixels: <mark>fd 100</mark>"],zc),bk:sc("bk",1,["<u>bk(pixels)</u> Back. Moves in reverse by some pixels: <mark>bk 100</mark>"],zc),move:sc("move",1,["<u>move(x, y)</u> Slides right x and forward y pixels without turning: <mark>move 50, 100</mark>"],Ac),movexy:sc("movexy",1,["<u>movexy(x, y)</u> Changes graphing coordinates by x and y: <mark>movexy 50, 100</mark>"],Bc),moveto:sc("moveto",1,["<u>moveto(x, y)</u> Move to graphing coordinates (see <u>getxy</u>): <mark>moveto 50, 100</mark>","<u>moveto(obj)</u> Move to page coordinates or an object on the page (see <u>pagexy</u>): <mark>moveto lastmousemove</mark>"],Cc),jump:sc("jump",1,["<u>jump(x, y)</u> Move without drawing (compare to <u>move</u>): <mark>jump 0, 50</mark>"],Dc(Ac)),jumpxy:sc("jumpxy",1,["<u>jumpxy(x, y)</u> Move without drawing (compare to <u>movexy</u>): <mark>jump 0, 50</mark>"],Dc(Bc)),jumpto:sc("jumpto",1,["<u>jumpto(x, y)</u> Move without drawing (compare to <u>moveto</u>): <mark>jumpto 50, 100</mark>"],Dc(Cc)),turnto:sc("turnto",1,["<u>turnto(degrees)</u> Turn to a direction. North is 0, East is 90: <mark>turnto 270</turnto>","<u>turnto(x, y)</u> Turn to graphing coordinates: <mark>turnto 50, 100</mark>","<u>turnto(obj)</u> Turn to page coordinates or an object on the page: <mark>turnto lastmousemove</mark>"],function(b,c,d){a.isNumeric(d)&&a.isNumeric(c)&&(c=[c,d],d=null);var e=uf;return this.plan(function(f,g){if(b.appear(f),a.isWindow(g)||9===g.nodeType)return void b.resolve(f);var h,i,j,k=null,l=null,m=null;if(a.isNumeric(c))i=ua(c),j=Y(g),l={pageX:j.pageX+1024*Math.sin(i),pageY:j.pageY-1024*Math.cos(i)},k=d;else if(a.isArray(c))m=W(g),m[0]-=c[0],m[1]-=c[1];else if(kb(c))l=c;else try{l=a(c).pagexy()}catch(n){return void b.resolve(f)}m||(m=W(g,l));var o=ta(Math.atan2(-m[0],-m[1]));h=qa(g,!0),null!==k&&(i=ua(h.rot),o=C(h.rot,o,null===k?360:k)),o=h.rot+va(o-h.rot);var p=this.css("turtleTurningRadius");this.css({turtleTurningRadius:0}),this.animate({turtleRotation:o},nb(g,e),ob(g)),this.plan(function(){this.css({turtleTurningRadius:p}),b.resolve(f)})}),this}),home:sc("home",0,["<u>home()</u> Goes home. Jumps to the center without drawing: <mark>do home</mark>"],function(b,c){return this.plan(function(d,e){b.appear(d);var f=this.css("turtlePenDown"),g=this.css("turtleTurningRadius"),h=c||V(e);this.css({turtlePenDown:"up",turtleTurningRadius:0}),this.css({turtlePosition:U(e,a(h).pagexy(),null,0,0),turtleRotation:0,turtleScale:1}),this.css({turtlePenDown:f,turtleTurningRadius:g}),b.resolve(d)}),this}),copy:sc("copy",0,["<u>copy()</u> makes a new turtle that is a copy of this turtle."],function(b){var c=this.clone().insertAfter(this);return c.hide(),this.plan(function(d,e){b.appear(d);var f=Ma(this),g=Ma(c);for(var h in f)g[h]=f[h];c.attr("style",this.attr("style"));for(var i in a.cssHooks){var j=this.css(i);c.css(i,j)}var k=this.prop("attributes");for(var l in k)c.attr(k[l].name,k[l].value);var m=c.canvas(),n=this.canvas();if(m&&n){m.width=n.width,m.height=n.height;var o=m.getContext("2d");o.drawImage(n,0,0)}c.show(),b.resolve(d)}),jc(c,this),c}),pen:sc("pen",1,["<u>pen(color, size)</u> Selects a pen. Chooses a color and/or size for the pen: <mark>pen red</mark>; <mark>pen 0</mark>; <mark>pen erase</mark>; <mark>pen blue, 5</mark>.","<u>pen(on-or-off)</u> Turns the pen on or off: <mark>pen off</mark>; <mark>pen on</mark>."],function(b,c,d){var e=Dd(arguments,1,{lineCap:/^(?:butt|square|round)$/,lineJoin:/^(?:bevel|round|miter)$/,lineWidth:a.isNumeric,penStyle:"*"});c=e.penStyle,c&&"function"==typeof c&&(c.helpname||c.name)&&(c=c.helpname||c.name),0===e.lineWidth||null===c?c="none":c===ye?c="black":a.isPlainObject(c)&&(c=Ja(c));var f=uf;return this.plan(function(a,d){b.appear(a);var g=!L(d)&&!nc(this),h=g&&Ia(this.css("turtlePenStyle")),i=h&&"down"==this.css("turtlePenDown"),j=!1;if(c===!1||c===!0||"down"==c||"up"==c?(this.css("turtlePenDown",c),j=!0):(e.lineWidth&&(c+=";lineWidth:"+e.lineWidth),e.lineCap&&(c+=";lineCap:"+e.lineCap),e.lineJoin&&(c+=";lineJoin:"+e.lineJoin),this.css("turtlePenStyle",c),this.css("turtlePenDown","none"==c?"up":"down")),g){var k=Ia(this.css("turtlePenStyle")),l=k&&(k.strokeStyle||k.savePath&&"gray")||h&&h.strokeStyle||"gray",m={},n=k&&"down"==this.css("turtlePenDown"),o=new Ne(l+" pencil",this.parent()),p=this.height();o.css({zIndex:1,turtlePosition:U(o.get(0),this.pagexy(),null,0,0),turtleRotation:this.css("turtleRotation"),turtleSpeed:1/0}),i?n||(m.turtleForward="+="+p,m.opacity=0):(o.css({turtleForward:"+="+p,opacity:0}),n&&(m.turtleForward="-="+p,m.opacity=1)),h&&!k&&"down"==i?(m.turtleForward="+="+p,m.opacity=0):h==k||h&&k&&h.strokeStyle==k.strokeStyle||(o.css({opacity:0}),m.opacity=1),o.animate(m,nb(d,f)),this.queue(function(a){o.done(function(){o.remove(),a()})})}this.plan(function(){b.resolve(a)})}),this}),fill:sc("fill",0,["<u>fill(color)</u> Fills a path traced using <u>pen path</u>: <mark>pen path; rt 100, 90; fill blue</mark>"],function(b,c){c?a.isPlainObject(c)&&(c=Ja(c)):c="none";var d=Ia(c,"fillStyle");return this.plan(function(a,c){b.appear(a),ab(c,d),b.resolve(a)}),this}),dot:sc("dot",0,["<u>dot(color, diameter)</u> Draws a dot. Color and diameter are optional: <mark>dot blue</mark>"],Ec(Fc)),box:sc("box",0,["<u>box(color, size)</u> Draws a box. Color and size are optional: <mark>dot blue</mark>"],Ec(Gc)),arrow:sc("arrow",0,["<u>arrow(color, size)</u> Draws an arrow. <mark>arrow red, 100</mark>"],Ec(Hc)),mirror:sc("mirror",1,["<u>mirror(flipped)</u> Mirrors the turtle across its main axis, or unmirrors if flipped if false. <mark>mirror(true)</mark>"],function(b,c){return this.plan(function(d,e){b.appear(d);var f=a.map(a.css(e,"turtleScale").split(" "),parseFloat);1===f.length&&f.push(f[0]),f[0]*f[1]<0==!c&&(f[0]=-f[0],this.css("turtleScale",f.join(" "))),b.resolve(d)}),this}),twist:sc("twist",1,["<u>twist(degrees)</u> Set the primary direction of the turtle. Allows use of images that face a different direction than 'up': <mark>twist(-90)</mark>"],function(b,c){return this.plan(function(d,e){b.appear(d),a.isWindow(e)||9===e.nodeType||(this.css("turtleTwist",c),b.resolve(d))}),this}),scale:sc("scale",1,["<u>scale(factor)</u> Scales all motion up or down by a factor. To double all drawing: <mark>scale(2)</mark>"],function(b,c,d){d===ye&&(d=c),c&&d||(c=d=1);var e=uf;return this.plan(function(f,g){if(b.appear(f),a.isWindow(g)||9===g.nodeType)return void b.resolve(f);var h=a.map(a.css(g,"turtleScale").split(" "),parseFloat);1===h.length&&h.push(h[0]),h[0]*=c,h[1]*=d,this.animate({turtleScale:a.map(h,ra).join(" ")},nb(g,e),ob(g),b.resolver(f))}),this}),pause:sc("pause",1,["<u>pause(seconds)</u> Pauses some seconds before proceeding. <mark>fd 100; pause 2.5; bk 100</mark>","<u>pause(turtle)</u> Waits for other turtles to be done before proceeding. <mark>t = new Turtle().fd 100; pause t; bk 100</mark>"],function(b,c){var d=null,e=null;return c&&a.isFunction(c.done)?(d=c,e=c.done):a.isFunction(c)&&(e=c),e?this.queue(function(){var b=this;e.call(d,function(){var c=b;b=null,c&&a.dequeue(c)})}):this.plan(function(a,d){b.appear(a),pc(d,c),this.plan(b.resolver(a))}),this}),st:sc("st",0,["<u>st()</u> Show turtle. The reverse of <u>ht()</u>. <mark>do st</mark>"],function(a){return this.plan(function(b){a.appear(b),this.show(),a.resolve(b)}),this}),ht:sc("ht",0,["<u>ht()</u> Hide turtle. The turtle can be shown again with <u>st()</u>. <mark>do ht</mark>"],function(a){return this.plan(function(b){a.appear(b),this.hide(),a.resolve(b)}),this}),pu:function(){return this.pen(!1,qc(arguments,0))},pd:function(){return this.pen(!0,qc(arguments,0))},pe:function(){return this.pen("erase",qc(arguments,0))},pf:function(){return this.pen("path",qc(arguments,0))},clip:sc("clip",1,["<u>Clips tranparent bits out of the image of the sprite, and sets the hit region."],function(b,c){return null==c&&(c=.125),this.plan(function(d,e){if(b.appear(d),"CANVAS"==e.tagName){var f=ue(e,c),g=a(e),h=y(e);we(e,f),xe(f,parseFloat(g.css("width"))/e.width,parseFloat(g.css("height"))/e.height,-h[0],-h[1]),g.css("turtleHull",f)}b.resolve(d)})}),say:sc("say",1,['<u>say(words)</u> Say something. Use English words.<mark>say "Let\'s go!"</mark>'],function(a,b){return this.plan(function(c,d){a.appear(c),this.queue(function(d){var e=!1,f=null,g=function(){e||(clearInterval(f),e=!0,a.resolve(c),d())};try{var h=new SpeechSynthesisUtterance(b);h.addEventListener("end",g),h.addEventListener("error",g),speechSynthesis.speak(h),f=setInterval(function(){speechSynthesis.pending||speechSynthesis.speaking||g()},250)}catch(i){ze.console&&ze.console.log(i),g()}})}),this}),play:sc("play",1,['<u>play(notes)</u> Play notes. Notes are specified in <a href="http://abcnotation.com/" target="_blank">ABC notation</a>.  <mark>play "de[dBFA]2[cGEC]4"</mark>'],function(b,c){return this.plan(function(c,d){b.appear(c),this.queue(function(e){var f=Xb(d),g=a.makeArray(b.args),h=!0,i=function(){b.resolve(c),e()};g.length>0&&a.isPlainObject(g[0])&&g[0].hasOwnProperty("wait")&&(h=g[0].wait),h&&g.push(i),f.play.apply(f,g),h||i()})}),this}),tone:xc("tone",["<u>tone(freq)</u> Immediately sound a tone. <u>tone(freq, 0)</u> Stop sounding the tone. <u>tone(freq, v, secs)</u> Play a tone with a volume and duration. Frequency may be a number in Hz or a letter pitch. <mark>tone 440, 5</mark>"],function(a,b){var c=arguments;return this.each(function(a,b){var d=Xb(b);d.tone.apply(d,c)})}),silence:xc("silence",["<u>silence()</u> immediately silences sound from play() or tone()."],function(){return this.each(function(a,b){var c=Xb(b);c.silence()})}),speed:sc("speed",1,["<u>speed(persec)</u> Set one turtle's speed in moves per second: <mark>turtle.speed 60</mark>"],function(a,b){return this.plan(function(c,d){a.appear(c),this.css("turtleSpeed",b),this.plan(function(){a.resolve(c)})}),this}),wear:sc("wear",1,["<u>wear(color)</u> Sets the turtle shell color: <mark>wear turquoise</mark>","<u>wear(url)</u> Sets the turtle image url: <mark>wear 'http://bit.ly/1bgrQ0p'</mark>"],function(b,c,d){if(("object"==typeof c||"number"==typeof c)&&"string"==typeof d){var e=d;d=c,c=e}"number"==typeof d&&(d={height:d});var f=ed(c,"turtle"),g=uf;return f?(d&&a.extend(f.css,d),this.plan(function(a,c){b.appear(a),this.css({backgroundImage:"none"});var d=!1,e=null;fb(this,f,function(){d=!0;var a=e;a&&(e=null,a())}),nc(this)||this.delay(nb(c,g)),d||this.pause({done:function(a){d?a():e=a}}),this.plan(function(){b.resolve(a)})}),this):this}),saveimg:sc("saveimg",1,["<u>saveimg(filename)</u> Saves the turtle's image as a file. <mark>t.saveimg 'mypicture.png'</mark>"],function(a,b){return this.plan(function(c,d){a.appear(c);var e=!1;b||(b="img");var f=this.canvas();if(f){var g=f.toDataURL(),h=/^data:image\/(\w+);base64,(.*)$/i.exec(g);h?(h[1]&&b.toLowerCase().lastIndexOf("."+h[1].toLowerCase())!=Math.max(0,b.length-h[1].length-1)&&(b+="."+h[1]),e=!0,jf.save(b,atob(h[2]),function(){a.resolve(c)})):If.html('<span style="color:red">Cannot saveimg: canvas toDataURL did not work as expected.</span>')}else If.html('<span style="color:red">Cannot saveimg: not a canvas</span>');e||a.resolve(c)})}),drawon:sc("drawon",1,["<u>drawon(canvas)</u> Switches to drawing on the specified canvas. <mark>A = new Sprite('100x100'); drawon A; pen red; fd 50; done -> A.rt 360</mark>"],function(b,c){return this.each(function(){var a=Ma(this);a.drawOnCanvasSync&&jc(this,a.drawOnCanvasSync),a.drawOnCanvasSync=c}),jc(c,this),this.plan(function(d,e){b.appear(d);var f=Ma(e);c&&c!==ze?c.jquery&&a.isFunction(c.canvas)?f.drawOnCanvas=c.canvas():c.tagName&&"CANVAS"==c.tagName?f.drawOnCanvas=c:(1==c.nodeType||9==c.nodeType)&&(f.drawOnCanvas=a(c).canvas()):f.drawOnCanvas=null,b.resolve(d)})}),label:sc("label",1,["<u>label(text)</u> Labels the current position with HTML: <mark>label 'remember'</mark>","<u>label(text, styles, labelsite)</u> Optional position specifies 'top', 'bottom', 'left', 'right', and optional styles is a size or CSS object: <mark>label 'big', { color: red, fontSize: 100 }, 'bottom'</mark>"],function(b,c,d,e){if((!e||"string"==typeof e)&&(a.isNumeric(d)||a.isPlainObject(d))){var f=e;e=d,d=f}a.isNumeric(e)&&(e={fontSize:e}),null==d&&(d=e&&"labelSide"in e?e.labelSide:e&&"label-side"in e?e["label-side"]:d="rotated scaled");var g=uf;return this.plan(function(f,h){b.appear(f);for(var i={padding:8},j=this.prop("style"),f=0;f<j.length;++f){var k=j[f];/^(?:width|height|opacity|background-image|background-size)$/.test(k)||/transform/.test(k)||(i[a.camelCase(k)]=j[k])}a.extend(i,{position:"absolute",display:"table",top:0,left:0},e);var l=wd(c,"label").result.css(i).addClass("turtlelabel").appendTo(xa());e&&"id"in e&&l.attr("id",e.id),e&&"class"in e&&l.addClass(e["class"]);var m=/\brotated\b/.test(d),n=/\bscaled\b/.test(d);l.css({turtlePosition:U(l.get(0),this.pagexy(),null,0,0),turtleRotation:m?this.css("turtleRotation"):0,turtleScale:n?this.css("turtleScale"):1});var o=l.get(0).getBoundingClientRect();/\b(?:top|bottom)\b/.test(d)&&(i.top=(/\btop\b/.test(d)?-1:1)*o.height/2),/\b(?:left|right)\b/.test(d)&&(i.left=(/\bleft\b/.test(d)?-1:1)*o.width/2),l.css(i),nc(this)||this.delay(nb(h,g)),this.plan(function(){b.resolve(f)})})}),reload:sc("reload",0,["<u>reload()</u> Does a reload, recycling content (cycling animated gifs)."],function(b){return this.plan(function(c,d){if(b.appear(c),a.isWindow(d)||9===d.nodeType)return ze.location.reload(),void b.resolve(c);if(d.src){var e=d.src;d.src="",d.src=e}b.resolve(c)}),this}),hatch:function(b,c){if(this.length){c!==ye||a.isNumeric(b)||(c=b,b=1);var d=this[0];if(a.isWindow(d)||9===d.nodeType?d=xa():/^(?:br|img|input|hr|canvas)$/i.test(d.tagName)&&(d=d.parentElement),1===b)return gd("function"==typeof c?c(0):c,d,"turtle");for(var e=0,f=[];b>e;++e)f.push(gd("function"==typeof c?c(e):c,d,"turtle")[0]);return a(f)}},pagexy:tc("pagexy",["<u>pagexy()</u> Page coordinates {pageX:, pageY}, top-left based: <mark>c = pagexy(); fd 500; moveto c</mark>"],function(){if(this.length){var a=Y(this[0]);return{pageX:a.pageX,pageY:a.pageY}}}),getxy:tc("getxy",["<u>getxy()</u> Graphing coordinates [x, y], center-based: <mark>v = getxy(); move -v[0], -v[1]</mark>"],function(){return this.length?W(this[0]):void 0}),direction:tc("direction",["<u>direction()</u> Current turtle direction. North is 0; East is 90: <mark>direction()</mark>","<u>direction(obj)</u> <u>direction(x, y)</u> Returns the direction from the turtle towards an object or coordinate. Also see <u>turnto</u>: <mark>direction lastclick</mark>"],function(b,c){if(this.length){var d,e=this[0],f=b;if(f!==ye){if(d=a(e).pagexy(),a.isNumeric(c)&&a.isNumeric(b)&&(f=[b,c]),a.isArray(f)&&(f=X(e,[f])[0]),!kb(f))try{f=a(f).pagexy()}catch(g){}return f?ta(Math.atan2(f.pageX-d.pageX,d.pageY-f.pageY)):NaN}return a.isWindow(e)||9===e.nodeType?0:_(e)}}),distance:tc("distance",["<u>distance(obj)</u> Returns the distance from the turtle to another object: <mark>distance lastclick</mark>","<u>distance(x, y)</u> Returns the distance from the turtle to graphing coorindates: <mark>distance(100, 0)</mark>"],function(b,c){if(this.length){var d,e,f=this[0],g=a(f).pagexy();if(a.isNumeric(c)&&a.isNumeric(b)&&(b=[b,c]),a.isArray(b)&&(b=X(f,[b])[0]),!kb(b))try{b=a(b).pagexy()}catch(h){}return b?(d=b.pageX-g.pageX,e=b.pageY-g.pageY,Math.sqrt(d*d+e*e)):NaN}}),canvas:xc("canvas",["<u>turtle.canvas()</u> The canvas for the turtle image. Draw on the turtle: <mark>c = turtle.canvas().getContext('2d'); c.fillStyle = red; c.fillRect(10, 10, 30, 30)</mark>"],function(){return this.filter("canvas").get(0)||this.find("canvas").get(0)}),imagedata:xc("imagedata",["<u>imagedata()</u> Returns the image data for the turtle. <mark>imdat = imagedata(); write imdat.data.length, 'bytes'</mark>","<u>imagedata(imdat)</u> Sets the image data for the turtle. <mark>imagedata({width: 1, height:1, data:[255,0,0,255]});</mark>"],function(b){var c=this.canvas();if(!c){if(b)throw new Error("can only set imagedata on a canvas like a Sprite");var d=this.filter("img").get(0);if(!d)return;c=Ea(d.naturalWidth,d.naturalHeight),c.getContext("2d").drawImage(d,0,0)}var e=c.getContext("2d");if(!b)return e.getImageData(0,0,c.width,c.height);if(!(b instanceof ImageData)){if("object"!=typeof b||!a.isNumeric(b.width)||!a.isNumeric(b.height)||!(a.isArray(b.data)||b.data instanceof Uint8ClampedArray||b.data instanceof Unit8Array))return;for(var f=e.createImageData(Math.round(b.width),Math.round(b.height)),g=Math.min(b.data.length,f.data.length),h=0;g>h;++h)f.data[h]=b.data[h];b=f}if(b.width!=c.width||b.height!=c.height){var i=y(c);c.width=b.width,c.height=b.height;var j=y(c);Jb(c,i,j),a(c).css("turtleHull","auto"),e=c.getContext("2d")}e.putImageData(b,0,0)}),cell:xc("cell",["<u>cell(r, c)</u> Row r and column c in a table. Use together with the table function: <mark>g = table 8, 8; g.cell(0,2).text 'hello'</mark>"],function(b,c){var d=this.find(a.isNumeric(b)?"tr:nth-of-type("+(b+1)+")":"tr");return d.find(a.isNumeric(c)?"td:nth-of-type("+(c+1)+")":"td")}),shown:tc("shown",["<u>shown()</u> True if turtle is shown, false if hidden: <mark>do ht; write shown()</mark>"],function(){var a=this.get(0);return a&&!L(a)}),hidden:tc("hidden",["<u>hidden()</u> True if turtle is hidden: <mark>do ht; write hidden()</mark>"],function(){var a=this.get(0);return!a||L(a)}),inside:tc("inside",["<u>inside(obj)</u> True if the turtle is encircled by obj: <mark>inside(window)</mark>"],function(b){if(!b)return!1;if("string"==typeof b&&(b=a(b)),b.jquery){if(!b.length||L(b[0]))return!1;b=b[0]}for(var c,d=N(b),e=null,f=!1,g=!0,h=0;g&&h<this.length;++h){if(c=this[h],Q(d,N(c)))return!1;e||(e=$(b),f=S(e,d)),f&&R(d,N(c))||(g&=kb(c)?da(c,e):ja(e,$(c)))}return!!g}),touches:tc("touches",["<u>touches(obj)</u> True if the turtle touches obj: <mark>touches(lastclick)</mark>","<u>touches(color)</u> True if the turtle touches a drawn color: <mark>touches red</mark>"],function(b,c){if(!this.length||L(this[0]))return!1;if("function"==typeof b&&Vc(b.helpname)&&(b=b.helpname),"color"==b||Vc(b))return eb(this[0],"color"==b?null:b);if(a.isNumeric(b)&&a.isNumeric(c)&&(b=[b,c]),a.isArray(b)&&2==b.length&&a.isNumeric(b[0])&&a.isNumeric(b[1])&&(b=X(this[0]||document.body,[b])[0]),!b)return!1;"string"==typeof b&&(b=a(b)),b.jquery||a.isArray(b)||(b=[b]);for(var d,e,f,g,h,i,j=!1,k=0;!j&&k<this.length;++k)if(f=this[k],g=N(f),0!=g.width)for(h=null,d=0;!j&&d<b.length;++d)e=b[d],i=N(e),Q(g,i)||(0!=i.width||null!=e.pageX&&null!=e.pageY)&&(h||(h=$(f)),j|=kb(e)?da(e,h):ia(h,$(e)));return!!j}),within:tc("within",["<u>within(distance, obj)</u> Filters elements to those within distance of obj: <mark>$('.turtle').within(100, lastclick)</mark>"],function(a,b,c){return Kb(this,!0,a,b,c)}),notwithin:tc("notwithin",["<u>within(distance, obj)</u> Filters elements to those further than distance of obj: <mark>$('.turtle').notwithin(100, lastclick)</mark>"],function(a,b,c){return Kb(this,!1,a,b,c)}),nearest:tc("nearest",["<u>nearest(obj)</u> Filters elements to those nearest obj<mark>$('.turtle').neareest(lastclick)</mark>"],function(b,c){var d,e,f,g=[],h=1/0;if(d=a.isNumeric(d)&&a.isNumeric(c)?[b,c]:b,a.isArray(d)&&(d=X(this[0]||document.body,[d])[0]),!kb(d))try{d=a(d).pagexy()}catch(i){d=null}for(f=0;f<this.length;f++)if(e=N(this[f]),!g.length||!O(d,h,e)){var j=Y(this[f]),k=d.pageX-j.pageX,l=d.pageY-j.pageY,m=k*k+l*l;h>=m&&(h>m&&(h=m,g.length=0),g.push(this[f]))}return a(g)}),done:xc("done",["<u>done(fn)</u> Calls fn when animation is complete. Use with await: <mark>await done defer()</mark>"],function(a){var b=this;return this.promise().done(function(){if(b){var c=b;De+=1,setTimeout(function(){De-=1,c.promise().done(a)},0)}else a.apply(this,arguments)})}),plan:xc("plan",["<u>plan(fn)</u> Runs fn in the animation queue. For planning logic: <mark>write getxy(); fd 50; plan -> write getxy(); bk 50"],function(c,d,e){function f(f,g,h){var i=e?function(){d.apply(a(f),e)}:function(){d.call(a(f),g,f)},j=(h.length&&h[h.length-1],function(){var d=a.queue(this,c),e=[];"inprogress"===d[0]&&e.unshift(d.shift()),a.queue(f,c,e),i(),Array.prototype.push.apply(a.queue(f,c),d),b(f,c)});j.finish=i,a.queue(f,c,j)}a.isFunction(c)&&(e=d,d=c,c="fx");for(var g,h=this.length,i=0;h>i;++i){g=this[i],Lc(g,c);var j=a.queue(g,c);j.length?f(g,i,j):e?d.apply(a(g),e):d.call(a(g),i,g)}return this})},_e={},af=0,bf=null,cf=null;Oc($e,"slide","move"),Oc($e,"direct","plan"),Oc($e,"enclosedby","inside"),Oc($e,"bearing","direction"),a.fn.extend($e);var df="data:image/gif;base64,R0lGODlhKAAwAPIFAAAAAAFsOACSRTCuSICAgP///wAAAAAAACH5BAlkAAYAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAKAAwAAAD72i6zATEgBCAebHpzUnxhDAMAvhxKOoV3ziuZyo3RO26dTbvgXj/gsCO9ysOhENZz+gKJmcUkmA6PSKfSqrWieVtuU+KGNXbXofLEZgR/VHCgdua4isGz9mbmM6U7/94BmlyfUZ1fhqDhYuGgYqMkCOBgo+RfWsNlZZ3ewIpcZaIYaF6XaCkR6aokqqrk0qrqVinpK+fsbZkuK2ouRy0ob4bwJbCibthh6GYebGcY7/EsWqTbdNG1dd9jnXPyk2d38y0Z9Yub2yA6AvWPYk+zEnkv6xdCoPuw/X2gLqy9vJIGAN4b8pAgpQOIlzI8EkCACH5BAlkAAYALAAAAAAoADAAAAPuaLrMBMSAEIB5senNSfGEMAwC+HEo6hXfOK5nKjdE7bp1Nu+BeP+CwI73Kw6EQ1nP6AomZxSSYDo9Ip9KqtaJ5W25Xej3qqGYsdEfZbMcgZXtYpActzLMeLOP6c7f3nVNfEZ7TXSFg4lyZAYBio+LZYiQfHMbc3iTlG9ilGpdjp4ujESiI6RQpqegqkesqqhKrbEpoaa0KLaiuBy6nrxss6+3w7tomo+cDXmBnsoLza2nsb7SN2tl1nyozVOZTJhxysxnd9XYCrrAtT7KQaPruavBo2HQ8xrvffaN+GV5/JbE45fOG8Ek5Q4qXHgwAQA7",ef={click:1,dblclick:1,mouseup:1,mousedown:1,mousemove:1},ff=null,gf=[],hf=!1,jf={interrupt:xc("interrupt",["<u>interrupt()</u> Interrupts and aborts all turtle commands."],function(b){if("reset"==b)return void(Ce=!1);if("test"==b)return Ce?!1:tf?!0:a.timers.length?!0:rf.length?!0:De?!0:Pc()?!0:a(":animated").length?!0:a(".turtle").filter(function(){return a.queue(this).length>0}).length>0?!0:a(".turtleinput").filter(function(){return!a(this).prop("disabled")}).length>0?!0:wc()?!0:!1;a(":animated,.turtle").clearQueue().stop(),_b(),a(".turtleinput").prop("disabled",!0),a(ze).off(".turtleevent"),a("*").not("#_testpanel *").map(function(b,c){a._data(c,"events",null)}),Ce=!0,ld(null,null),jd();for(var c=a.timers.length-1;c>=0;--c)a.timers[c].anim&&a.timers[c].anim.elem&&a(a.timers[c].anim.elem).stop(!0,!0);var d=b?"'"+b+"'":"";throw new Error("interrupt("+d+") called")}),cs:uc("cs",["<u>cs()</u> Clear screen. Erases both graphics canvas and body text: <mark>do cs</mark>"],function(){bb()}),cg:uc("cg",["<u>cg()</u> Clear graphics. Does not alter body text: <mark>do cg</mark>"],function(){bb("canvas labels")}),ct:uc("ct",["<u>ct()</u> Clear text. Does not alter graphics canvas: <mark>do ct</mark>"],function(){bb("text")}),canvas:xc("canvas",["<u>canvas()</u> Returns the raw turtle canvas. <mark>c = canvas().getContext('2d'); c.fillStyle = red; c.fillRect(100,100,200,200)</mark>"],function(){return Da()}),sizexy:xc("sizexy",["<u>sizexy()</u> Get the document pixel [width, height]. <mark>[w, h] = sizexy(); canvas('2d').fillRect(0, 0, w, h)</mark>"],Ga),forever:xc("forever",["<u>forever(fn)</u> Calls fn repeatedly, forever. <mark>forever -> fd 2; rt 2</mark>","<u>forever(fps, fn)</u> Calls fn repeating fps per second. <mark>forever 2, -> fd 25; dot blue</mark>"],id),stop:xc("stop",["<u>stop()</u> stops the current forever loop. <mark>forever -> fd 10; if not inside window then stop()</mark>","<u>stop(fn)</u> stops the forever loop corresponding to fn.","Use <u>break</u> to stop a <u>for</u> or <u>while</u> loop."],kd),tick:xc("tick",["<u>tick(fps, fn)</u> Calls fn fps times per second until <u>tick</u> is called again: <mark>c = 10; tick 1, -> c and write(c--) or tick()</mark>"],function(b,c){if(Pc()){var d=a(ff);d.plan(function(){ld(b,c)})}else ld(b,c)}),speed:uc("speed",["<u>speed(mps)</u> Sets default turtle speed in moves per second: <mark>speed Infinity</mark>"],function(a){md(a)}),play:xc("play",['<u>play(notes)</u> Play notes. Notes are specified in <a href="http://abcnotation.com/" target="_blank">ABC notation</a>.  <mark>play "de[dBFA]2[cGEC]4"</mark>'],function(){if(ff){var b=a(ff);b.play.apply(b,arguments)}else{var c=rc(null,"play",arguments,0);c.appear(null);var d=Yb(),e=a.makeArray(c.args);e.push(function(){c.resolve(null)}),d.play.apply(d,e),c.exit()}}),tone:xc("tone",["<u>tone(freq)</u> Immediately sound a tone. <u>tone(freq, 0)</u> Stop sounding the tone. <u>tone(freq, v, secs)</u> Play a tone with a volume and duration. Frequency may be a number in Hz or a letter pitch. <mark>tone 440, 5</mark>"],function(){if(ff){var b=a(ff);b.tone.apply(b,arguments)}else{var c=Yb();c.play.apply(c,args)}}),silence:xc("silence",["<u>silence()</u> Immediately silences sound from play() or tone()."],function(){if(ff){var b=a(ff);b.silence()}else{var c=Yb();c.silence()}}),sync:xc("sync",["<u>sync(t1, t2, t3,...)</u> Selected turtles wait for each other to stop."],jc),remove:xc("remove",["<u>remove(t)</u> Remove selected turtles."],kc),done:xc("done",["<u>done(fn)</u> Calls fn when animation is complete. Use with await: <mark>await done defer()</mark>"],function(b){var c=a(".turtle");return c.promise().done(function(){if(c){var a=c;De+=1,setTimeout(function(){De-=1,a.promise().done(b)},0)}else b.apply(this,arguments)})}),load:xc("load",["<u>load(url, cb)</u> Loads data from the url and passes it to cb. <mark>load 'intro', (t) -> write 'intro contains', t</mark>"],function(b,c){var d;return a.ajax(Cb(b,"load"),{async:!!c,complete:function(e){try{if(d=e.responseObject=JSON.parse(e.responseText),"string"==typeof d.data&&"string"==typeof d.file){if(d=d.data,/\.json(?:$|\?|\#)/.test(b))try{d=JSON.parse(d)}catch(f){}}else a.isArray(d.list)&&"string"==typeof d.directory?d=d.list:d.error&&(d=null)}catch(f){null==d&&e&&e.responseText&&(d=e.responseText)}c&&c(d,e)}}),d}),save:xc("save",["<u>save(url, data, cb)</u> Posts data to the url and calls when done. <mark>save 'intro', 'pen gold, 20\\nfd 100\\n'</mark>"],function(b,c,d){if(!b)throw new Error("Missing url for save");var e,f={},b=Cb(b,"save");if(/\.json(?:$|\?|\#)/.test(b)&&(c=JSON.stringify(c,null,2)),"string"==typeof c||"number"==typeof c)f.data=c;else for(e in c)c.hasOwnProperty(e)&&("string"==typeof c[e]?f[e]=c[e]:f[e]=JSON.stringify(c[e]));if(f&&!f.key){var g=Eb();g&&g.key&&g.user==Bb(b)&&(f.key=g.key)}a.ajax(Cb(b,"save"),{type:"POST",data:f,complete:function(a){var b;try{b=JSON.parse(a.responseText)}catch(c){null==b&&a&&a.responseText&&(b=a.responseText)}d&&d(b,a)}})}),append:uc("append",["<u>append(html)</u> Appends text to the document without a new line. <mark>append 'try this twice...'</mark>"],function(b){a.fn.append.apply(a("body"),arguments)}),type:uc("type",["<u>type(text)</u> Types preformatted text like a typewriter. <mark>type 'Hello!\n'</mark>"],td),typebox:uc("typebox",["<u>typebox(clr)</u> Draws a colored box as typewriter output. <mark>typebox red</mark>"],function(a,b){null!=b||null==a||Vc(a)||(b=a,a=null),ud(a,b)}),typeline:uc("typebox",["<u>typeline()</u> Same as type '\\n'. <mark>typeline()</mark>"],function(a){td((a||"")+"\n")}),write:uc("write",["<u>write(html)</u> Writes a line of text. Arbitrary HTML may be written: <mark>write 'Hello, world!'</mark>"],vd,function(){return wd(Array.prototype.join.call(arguments," "),"div")}),read:uc("read",["<u>read(fn)</u> Reads text or numeric input. Calls fn once: <mark>read (x) -> write x</mark>","<u>read(html, fn)</u> Prompts for input: <mark>read 'Your name?', (v) -> write 'Hello ' + v</mark>"],vd,function(a,b){return zd(a,b,0)}),readnum:uc("readnum",["<u>readnum(html, fn)</u> Reads numeric input. Only numbers allowed: <mark>readnum 'Amount?', (v) -> write 'Tip: ' + (0.15 * v)</mark>"],vd,function(a,b){return zd(a,b,1)}),readstr:uc("readstr",["<u>readstr(html, fn)</u> Reads text input. Never converts input to a number: <mark>readstr 'Enter code', (v) -> write v.length + ' long'</mark>"],vd,function(a,b){return zd(a,b,-1)}),menu:uc("menu",["<u>menu(map)</u> shows a menu of choices and calls a function based on the user's choice: <mark>menu {A: (-> write 'chose A'), B: (-> write 'chose B')}</mark>"],vd,xd),button:uc("button",["<u>button(text, fn)</u> Writes a button. Calls fn whenever the button is clicked: <mark>button 'GO', -> fd 100</mark>"],vd,yd),table:uc("table",["<u>table(m, n)</u> Writes m rows and c columns. Access cells using <u>cell</u>: <mark>g = table 8, 8; g.cell(2,3).text 'hello'</mark>","<u>table(array)</u> Writes tabular data. Each nested array is a row: <mark>table [[1,2,3],[4,5,6]]</mark>"],vd,Bd),img:uc("img",["<u>img(url)</u> Writes an image with the given address. Any URL can be provided.  A name without slashes will be treated as '/img/name'.<mark>t = img 'tree'</mark>"],vd,Ad),random:xc("random",["<u>random(n)</u> Random non-negative integer less than n: <mark>write random 10</mark>","<u>random(list)</u> Random member of the list: <mark>write random ['a', 'b', 'c']</mark>","<u>random('position')</u> Random page position: <mark>moveto random 'position'</mark>","<u>random('color')</u> Random color: <mark>pen random 'color'</mark>"],hd),rgb:xc("rgb",["<u>rgb(r,g,b)</u> Makes a color out of red, green, and blue parts. <mark>pen rgb(150,88,255)</mark>"],function(a,b,c){return Cd("rgb",[Math.max(0,Math.min(255,Math.floor(a))),Math.max(0,Math.min(255,Math.floor(b))),Math.max(0,Math.min(255,Math.floor(c)))])}),hatch:function(b,c){return a(document).hatch(b,c)},rgba:xc("rgba",["<u>rgba(r,g,b,a)</u> Makes a color out of red, green, blue, and alpha. <mark>pen rgba(150,88,255,0.5)</mark>"],function(a,b,c,d){return Cd("rgba",[Math.max(0,Math.min(255,Math.floor(a))),Math.max(0,Math.min(255,Math.floor(b))),Math.max(0,Math.min(255,Math.floor(c))),d])}),hsl:xc("hsl",["<u>hsl(h,s,l)</u> Makes a color out of hue, saturation, and lightness. <mark>pen hsl(120,0.65,0.75)</mark>"],function(a,b,c){return Cd("hsl",[a,(100*b).toFixed(0)+"%",(100*c).toFixed()+"%"])}),hsla:xc("hsla",["<u>hsla(h,s,l,a)</u> Makes a color out of hue, saturation, lightness, alpha. <mark>pen hsla(120,0.65,0.75,0.5)</mark>"],function(a,b,c,d){return Cd("hsla",[a,(100*b).toFixed(0)+"%",(100*c).toFixed(0)+"%",d])}),click:vc("click",["<u>click(fn)</u> Calls fn(event) whenever the mouse is clicked. <mark>click (e) -> moveto e; label 'clicked'</mark>"]),dblclick:vc("dblclick",["<u>dblclick(fn)</u> Calls fn(event) whenever the mouse is double-clicked. <mark>dblclick (e) -> moveto e; label 'double'</mark>"]),mouseup:vc("mouseup",["<u>mouseup(fn)</u> Calls fn(event) whenever the mouse is released. <mark>mouseup (e) -> moveto e; label 'up'</mark>"]),mousedown:vc("mousedown",["<u>mousedown(fn)</u> Calls fn(event) whenever the mouse is pressed. <mark>mousedown (e) -> moveto e; label 'down'</mark>"]),mousemove:vc("mousemove",["<u>mousemove(fn)</u> Calls fn(event) whenever the mouse is moved. <mark>mousemove (e) -> write 'at ', e.x, ',', e.y</mark>"]),
keydown:vc("keydown",["<u>keydown(fn)</u> Calls fn(event) whenever a key is pushed down. <mark>keydown (e) -> write 'down ' + e.key</mark>"]),keyup:vc("keyup",["<u>keyup(fn)</u> Calls fn(event) whenever a key is released. <mark>keyup (e) -> write 'up ' + e.key</mark>"]),keypress:vc("keypress",["<u>keypress(fn)</u> Calls fn(event) whenever a character key is pressed. <mark>keypress (e) -> write 'press ' + e.key</mark>"]),send:xc("send",["<u>send(name)</u> Sends a message to be received by recv. <mark>send 'go'; recv 'go', -> fd 100</mark>"],function(a){var b=arguments,c=Array.prototype.slice.call(b,1),d=lf.sent[a];d||(d=lf.sent[a]=[]),d.push(c),Qc(a)}),recv:xc("recv",["<u>recv(name, fn)</u> Calls fn once when a sent message is received. <mark>recv 'go', (-> fd 100); send 'go'</mark>"],function(a,b){var c=lf.waiting[a];c||(c=lf.waiting[a]=[]),c.push(b),Qc(a)}),abs:xc("abs",["<u>abs(x)</u> The absolute value of x. <mark>see abs -5</mark>"],Math.abs),acos:xc("acos",["<u>acos(degreees)</u> Trigonometric arccosine, in degrees. <mark>see acos 0.5</mark>"],function(a){return Ua(180*Math.acos(a)/Math.PI)}),asin:xc("asin",["<u>asin(degreees)</u> Trigonometric arcsine, in degrees. <mark>see asin 0.5</mark>"],function(a){return Ua(180*Math.asin(a)/Math.PI)}),atan:xc("atan",["<u>atan(degreees)</u> Trigonometric arctangent, in degrees. <mark>see atan 0.5</mark>"],function(a){return Ua(180*Math.atan(a)/Math.PI)}),atan2:xc("atan2",["<u>atan2(degreees)</u> Trigonometric two-argument arctangent, in degrees. <mark>see atan -1, 0</mark>"],function(a,b){return Ua(180*Math.atan2(a,b)/Math.PI)}),cos:xc("cos",["<u>cos(degreees)</u> Trigonometric cosine, in degrees. <mark>see cos 45</mark>"],function(a){return Ua(Math.cos(a%360*Math.PI/180))}),sin:xc("sin",["<u>sin(degreees)</u> Trigonometric sine, in degrees. <mark>see sin 45</mark>"],function(a){return Ua(Math.sin(a%360*Math.PI/180))}),tan:xc("tan",["<u>tan(degreees)</u> Trigonometric tangent, in degrees. <mark>see tan 45</mark>"],function(a){return Ua(Math.tan(a%360*Math.PI/180))}),ceil:xc("ceil",["<u>ceil(x)</u> Round up. <mark>see ceil 1.9</mark>"],Math.ceil),floor:xc("floor",["<u>floor(x)</u> Round down. <mark>see floor 1.9</mark>"],Math.floor),round:xc("round",["<u>round(x)</u> Round to the nearest integer. <mark>see round 1.9</mark>"],Math.round),exp:xc("exp",["<u>exp(x)</u> Raise e to the power x. <mark>see exp 2</mark>"],Math.exp),ln:xc("ln",["<u>ln(x)</u> The natural logarithm of x. <mark>see ln 2</mark>"],Math.log),log10:xc("log10",["<u>log10(x)</u> The base 10 logarithm of x. <mark>see log10 0.01</mark>"],function(a){return Ua(Math.log(a)*Math.LOG10E)}),pow:xc("pow",["<u>pow(x, y)</u> Raise x to the power y. <mark>see pow 4, 1.5</mark>"],function(a,b){return Ua(Math.pow(a,b))}),sqrt:xc("sqrt",["<u>sqrt(x)</u> The square root of x. <mark>see sqrt 25</mark>"],Math.sqrt),max:xc("max",["<u>max(x, y, ...)</u> The maximum of a set of values. <mark>see max -5, 2, 1</mark>"],Math.max),min:xc("min",["<u>min(x, y, ...)</u> The minimum of a set of values. <mark>see min 2, -5, 1</mark>"],Math.min),Pencil:xc("Pencil",["<u>new Pencil(canvas)</u> Make an invisble pencil for drawing on a canvas. <mark>s = new Sprite; p = new Pencil(s); p.pen red; p.fd 100; remove p</mark>"],Me),Turtle:xc("Turtle",["<u>new Turtle(color)</u> Make a new turtle. <mark>t = new Turtle; t.fd 100</mark>"],Ne),Piano:xc("Piano",["<u>new Piano(keys)</u> Make a new piano. <mark>t = new Piano 88; t.play 'edcdeee'</mark>"],Pe),Webcam:xc("Webcam",["<u>new Webcam(options)</u> Make a new webcam. <mark>v = new Webcam; v.plan -> pic = new Sprite v</mark>"],Oe),Sprite:xc("Sprite",["<u>new Sprite({width:w,height:h,color:c})</u> Make a new sprite to <mark>drawon</mark>. <mark>s = new Sprite({width:50,height:50,color:blue}); s.fd 100</mark>"],Le),loadscript:xc("loadscript",["<u>loadscript(url, callback)</u> Loads Javascript or Coffeescript from the given URL, calling callback when done."],function(b,c){ze.CoffeeScript&&/\.(?:coffee|cs)$/.test(b)?CoffeeScript.load(b,c):a.getScript(b,c)}),pressed:xc("pressed",["<u>pressed('control')</u> Tests if a specific key is pressed. <mark>if pressed 'a' then write 'a was pressed'</mark>","<u>pressed.list()</u> Returns a list of pressed keys, by name. <mark>write 'Pressed keys: ' + pressed.list().join(',')</mark>"],Se),help:mc},kf={finish:{helptext:["<u>finish()</u> Finishes turtle animation. Does not pause for effect: <mark>do finish</mark>"]}},lf={sent:{},waiting:{},pollTimer:null};Oc(jf,"defaultspeed","speed");var mf={},nf=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","transparent"];!function(){for(var a=["none","erase","path","up","down","color","position","normal","touch"],b=a.concat(nf),c=0;c<b.length;c++)jf.hasOwnProperty(b[c])||(jf[b[c]]=b[c]);jf.PI=Math.PI,jf.E=Math.E,jf.print=jf.write,kf.colors={helptext:["Defined colors: "+nf.join(" ")]},kf.see={helptext:["<u>see(v)</u> Shows the value of v in the test panel: <mark>see document</mark>"]},kf["if"]=kf["else"]=kf.then={helptext:["<u>if</u> <u>then</u> <u>else</u> Tests a condition: <mark>if 1 <= (new Date).getDay() <= 5 then write 'Working hard!' else write 'Happy weekend!'</mark>"]},kf.await=kf.defer={helptext:['<u>await</u> <u>defer</u> Waits for results from an asynchronous event; from <a href="http://maxtaco.github.io/coffee-script/" target="_blank">Iced CoffeeScript</a>: <mark>await readnum defer n</mark>']}}(),a.turtle=function(b,c){var d=!1;if(arguments.length||(b="turtle"),1==arguments.length&&"object"==typeof b&&b&&!b.hasOwnProperty("length")&&(c=b,b="turtle"),c=c||{},"turtle"in c&&(b=c.turtle),Uc(),"htmlscript"in c&&!c.htmlscript||a('script[type="text/html"]').each(function(){a(this).replaceWith(a(this).html().replace(/^\x3c!\[CDATA\[\n?|\]\]\x3e$/g,""))}),!Ie.ctx&&"subpixel"in c&&(Ie.subpixel=parseInt(c.subpixel)),a.turtle.hangtime="hangtime"in c?parseFloat(c.hangtime):1e4,"events"in c&&!c.events||od(c.eventprefix),"pressed"in c&&!c.pressed||(Ub(),Se.enable(!0)),"see"in c&&!c.see||(Id(),d=!0,ze.addEventListener?ze.addEventListener("error",If):ze.onerror=If,ze.log=If),"functions"in c&&!c.functions||(ze.printpage=ze.print,a.extend(ze,jf)),md("defaultspeed"in c?c.defaultspeed:1),Zb())try{$b()}catch(e){}var f=null,g=!1;if(b&&(f=a("#"+b),f.length||(a("body").length||(document.write("<body>"),g=!0),f=new Ne(b))),f&&!f.length&&(f=null),f&&1===f.length&&(!("global"in c)||c.global)){var h={css:1,fadeIn:1,fadeOut:1,fadeTo:1,fadeToggle:1,animate:1,toggle:1,finish:1,promise:1,direct:1},i=a.extend({},$e,h);gf.push.apply(gf,Tc(f,i)),ff=f[0],f.css({zIndex:1})}if("ids"in c&&!c.ids||(nd(c.idprefix),f&&b&&(ze[b]=f)),!("panel"in c)||c.panel){var j={title:"test panel (type help for help)",abbreviate:[ye,mf],consolehook:Rc};if(f&&j.abbreviate.push(f),c.title&&(j.title=c.title),c.panelheight&&(j.height=c.panelheight),If.init(j),d)return ze.CoffeeScript?"see.init(eval(see.cs))":If.here}},a.extend(a.turtle,jf);a.cleanData;a.cleanData=function(b){for(var c,d=0;(c=b[d])!==ye;d++){var e=a.data(c,"turtleData");e&&e.stream&&e.stream.stop(),c.id&&ze[c.id]&&ze[c.id].jquery&&1===ze[c.id].length&&ze[c.id][0]===c&&delete ze[c.id],c===ff&&Uc()}};var of={},pf={turtle:function(a){return a||(a="mediumseagreen"),{url:Yc(a),css:{width:20,height:24,transformOrigin:"10px 13px",turtleHull:"-8 -5 -8 6 -2 -13 2 -13 8 6 8 -5 0 9",opacity:.67,backgroundImage:"url("+df+")",backgroundSize:"cover"}}},pointer:function(a){return a||(a="gray"),{url:Zc(a),css:{width:20,height:24,transformOrigin:"10px 18px",turtleHull:"-10 6 0 -18 10 6",opacity:.67}}},radius:function(a){return a||(a="gray"),{url:$c(a),css:{width:20,height:20,transformOrigin:"10px 10px",turtleHull:"-10 0 -7 7 0 10 7 7 10 0 7 -7 0 -10 -7 -7",opacity:1}}},dot:function(a){return a||(a="black"),{url:_c(a,24),css:{width:12,height:12,transformOrigin:"6px 6px",turtleHull:"-6 0 -4 4 0 6 4 4 6 0 4 -4 0 -6 -4 -4",opacity:1}}},point:function(a){return a||(a="black"),{url:_c(a,6),css:{width:3,height:3,transformOrigin:"1.5px 1.5px",turtleHull:"-1.5 0 -1 1 0 1.5 1 1 1.5 0 1 -1 0 -1.5 -1 -1",opacity:1}}},pencil:function(a){return a||(a="dodgerblue"),{url:ad(a),css:{width:20,height:24,transformOrigin:"10px 24px",turtleHull:"0 0 -3 -6 -3 -24 3 -6 3 -24",opacity:1}}}},qf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},rf=[],sf=[],tf=null,uf=0,vf=null,wf={autoScrollTimer:null,bottomSeen:0},xf={init:function(){try{parent&&parent.ide&&(this.ide=parent.ide,this.ide.bindframe(ze),this.attached=!0)}catch(a){this.ide=null,this.attached=!1}this.attached&&ze.addEventListener&&ze.addEventListener("error",function(a){xf.reportEvent("error",[a])})},attached:!1,ide:null,reportEvent:function(a,b){this.ide&&this.ide.reportEvent(a,b)},nextId:function(){return this.ide?this.ide.nextId():0}};xf.init(),function(){function b(a){return a.toFixed(1).replace(/\.0$/,"")}function c(a){return'<code style="font-weight:bold;color:blue">'+a+"</code>"}function d(b,c){return b&&(b=b.get(0))&&c&&c.target&&(b==c.target||a.contains(b,c.target))}if(xf.ide){var e,f,g,h,i=a("<samp>").css({position:"fixed",zIndex:1e6-1,fontFamily:"sans-serif",display:"none",background:"#ff8",border:"1px solid dimgray",padding:"1px",cursor:"move",fontSize:12}).appendTo("body"),j=null,k=null,l=null,m=0,n=0,o=0,p=0;a(ze).on("mousedown mouseup mousemove keydown",function(q){if("keydown"==q.type){if(q.which<27)return;k&&k.remove(),k=j=l=null}if("mousedown"==q.type)if(k)if(l)k&&k.remove(),k=j=l=null;else if(j)k.css({cursor:"default"}),l=q;else{a.turtle.interrupt("reset");var r=a(".turtle").within("touch",q);j=r.length?r.eq(0):q}else if(d(i,q)){var s=Ga();l=j=null,k=a('<canvas width="'+s[0]+'" height="'+s[1]+'">').css({position:"absolute",top:0,left:0,cursor:"crosshair",zIndex:1e6}).appendTo("body")}if(k){var t,u,v,w,x,y,z,A=k.canvas(),B=A.getContext("2d"),C=!1,D=l||q;if(j&&"function"==typeof j.pagexy){var E=j.getxy(),t=j.pagexy();t.x=E[0],t.y=E[1],C=!0,y=j.direction(),u=["getxy is "+b(t.x)+", "+b(t.y),"direction is "+b(y)]}else t=j||D,u=[c("moveto "+b(t.x)+", "+b(t.y))];if(u.unshift(l?'<span style="color:green">click to close</span>':j?'<span style="color:red">click to measure</span>':'<span style="color:red">click on point</span>'),v=D.x-t.x,w=D.y-t.y,x=Math.sqrt(v*v+w*w),z=Math.atan2(v,w)/Math.PI*180,j){if(B.save(),B.clearRect(m-10,n-10,o-m+20,p-n+20),m=o=t.pageX,n=p=t.pageY,B.fillStyle="red",B.beginPath(),B.arc(t.pageX,t.pageY,4,0,2*Math.PI,!1),B.closePath(),B.fill(),x>0){if(C){B.strokeStyle="black",B.fillStyle="black",g=(y-90)/180*Math.PI,h=(z-90)/180*Math.PI,e=t.pageX+100*Math.cos(g),f=t.pageY+100*Math.sin(g),Kc(B,2,t.pageX,t.pageY,e,f),m=Math.min(e,m),n=Math.min(f,n),o=Math.max(e,o),p=Math.max(f,p);var F=(360+z-y)%360;B.beginPath(),180>=F?(u.push(c("rt "+b(F))),x>=20&&B.arc(t.pageX,t.pageY,20,g,h)):(u.push(c("lt "+b(360-F))),x>=20&&B.arc(t.pageX,t.pageY,20,h,g)),B.stroke(),m=Math.min(t.pageX-20,m),n=Math.min(t.pageY-20,n),o=Math.max(t.pageX+20,o),p=Math.max(t.pageY+20,p)}else u.push(c("turnto "+b(z)));u.push(c("fd "+b(x))),u.push("end at "+b(D.x)+", "+b(D.y)),B.strokeStyle="red",B.fillStyle="red",Kc(B,2,t.pageX,t.pageY,D.pageX,D.pageY),m=Math.min(D.pageX,m),n=Math.min(D.pageY,n),o=Math.max(D.pageX,o),p=Math.max(D.pageY,p)}B.restore()}i.css({left:0,top:0}).html(u.join("<br>")).show();var G={left:"",top:"",right:"",bottom:""};D.pageX+5<t.pageX?G.left=Math.max(D.pageX-a(ze).scrollLeft()-i.outerWidth()-5,2):G.left=Math.min(D.pageX-a(ze).scrollLeft()+5,a(document).width()-i.outerWidth()-2),D.pageY+5<t.pageY?G.top=Math.max(D.pageY-a(ze).scrollTop()-i.outerHeight()-5,2):G.top=Math.min(D.pageY-a(ze).scrollTop()+5,a(document).height()-i.outerHeight()-2),i.css(G)}else u=[],d(i,q)&&u.push('<span style="color:red">click to use</span>'),null!=q.x&&u.push(q.x+", "+q.y),i.html(u.join("<br>")).css({left:"",top:"",right:0,bottom:0}).show()})}}();var yf=null,zf="see",Af="0.2",Bf=Jd(zf),Cf="position:relative;display:block;font-family:monospace;font-size:16px;word-break:break-all;margin-bottom:3px;padding-left:1em;",Df=5,Ef=!1,Ff="body",Gf="auto";try{ze.self!==ze.top&&screen.width>=800&&screen.height>=600&&parent&&parent.ide&&(Gf=parent.ide.getOptions().panel)}catch(Hf){}var If,Jf=Gf,Kf="",Lf=null,Mf="_loghistory",Nf=50,Of="",Pf={"":{e:ze.eval,t:ze},top:{e:ze.eval,t:ze}},Qf=ze.CoffeeScript,Rf="(function(){return eval(arguments[0]);})",Sf="[_$a-zA-Z-][_$a-zA-Z0-9-]*",Tf=new RegExp("^\\s*var\\s+(?:"+Sf+"\\s*,\\s*)*"+Sf+"\\s*;\\s*"),Uf="input._log:focus{outline:none;}samp._logcaret{position:absolute;left:0;font-size:120%;}samp._logcaret:before{content: '>'}label._log > span:first-of-type:hover{text-decoration:underline;}samp._log > label._log,samp_.log > span > label._log{display:inline-block;vertical-align:top;}label._log > span:first-of-type{margin-left:2em;text-indent:-1em;}label._log > ul{display:none;padding-left:14px;margin:0;}label._log > span:before{content:'';font-size:70%;font-style:normal;display:inline-block;width:0;text-align:center;}label._log > span:first-of-type:before{content:'\\0025B6';}label._log > ul > li{display:block;white-space:pre-line;margin-left:2em;text-indent:-1em}label._log > ul > li > samp{margin-left:-1em;text-indent:0;white-space:pre;}label._log > input[type=checkbox]:checked ~ span{margin-left:2em;text-indent:-1em;}label._log > input[type=checkbox]:checked ~ span:first-of-type:before{content:'\\0025BC';}label._log > input[type=checkbox]:checked ~ span:before{content:'';}label._log,label._log > input[type=checkbox]:checked ~ ul{display:block;}label._log > span:first-of-type,label._log > input[type=checkbox]:checked ~ span{display:inline-block;}label._log > input[type=checkbox],label._log > input[type=checkbox]:checked ~ span > span{display:none;}",Vf=!1,Wf={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\v","'":"\\'",'"':'\\"',"\\":"\\\\"},Xf=null,Yf=[];If=function(){Lf&&"function"==typeof Lf.log&&Lf.log.apply(ze.console,arguments);var a=Array.prototype.slice.call(arguments);for(Yf.push('<samp class="_log">');a.length;){var b=a.shift();"String"==Od(b)?Yf.push($d(b)):Yf.push(ce(b,Df,Yf)),a.length&&Yf.push(" ")}Yf.push("</samp>"),fe()};var Zf=!1,$f=!1,_f=null,ag=[{}.undefined],bg=null,cg=null}}).call(this,this.jQuery);